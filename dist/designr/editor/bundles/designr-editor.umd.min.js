!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/common/http"),require("@angular/forms"),require("@angular/animations"),require("@angular/common"),require("@angular/core"),require("@designr/core"),require("ngx-markdown"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("@designr/editor",["exports","@angular/common/http","@angular/forms","@angular/animations","@angular/common","@angular/core","@designr/core","ngx-markdown","rxjs/operators"],e):e((t.designr=t.designr||{},t.designr.editor={}),t.ng.common.http,t.ng.forms,t.ng.animations,t.ng.common,t.ng.core,t.core,t.ngxMarkdown,t.rxjs.operators)}(this,function(t,e,o,r,i,s,l,p,c){"use strict";var n=function(){function t(){this.version="0.0.1"}return t.prototype.ngOnInit=function(){},t.decorators=[{type:s.Component,args:[{selector:"editor-module",template:'<span class="editor-module">editor {{version}}</span>'}]}],t.ctorParameters=function(){return[]},t}(),d=function(t,e){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)};var a=function(a){function t(t,e,o,n,r){var i=a.call(this)||this;return i.platformId=t,i.configService=e,i.markdownService=o,i.formService=n,i.pageResolverService=r,i.editing=!1,i.busy=!1,i.submitted=!1,i}return function n(t,e){function o(){this.constructor=t}d(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}(t,a),Object.defineProperty(t.prototype,"page",{get:function(){return this._page},set:function(t){var e=this;this._pageCopy=Object.assign({},t),this._page=t,this._page?(this.controls=this.formService.getControlsFromOptions(this.getControlsByPage(t)),this.group=this.formService.getGroupFromControls(this.controls),this.group.valueChanges.subscribe(function(t){e.onAssign(t)})):(this.controls=[],this.group=null)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"componentName",{get:function(){if(this._page){var t=this.configService.options.pages[this._page.component];if(t)return t.name}},enumerable:!0,configurable:!0}),t.prototype.getControlsByPage=function(o){return o?Object.keys(o).filter(function(t){return"object"!=typeof o[t]}).map(function(t,e){return{key:t,value:o[t],schema:"description"===t?"markdown":"text",label:t,placeholder:t,required:!1,order:e+1}}):[]},t.prototype.ngAfterViewInit=function(){var e=this;i.isPlatformBrowser(this.platformId)&&this.pageResolverService.events$.pipe(c.takeUntil(this.unsubscribe)).subscribe(function(t){e.page=t?t.page:null})},t.prototype.onKeydown=function(t){"e"===t.key&&t.ctrlKey&&(this.editing=!this.editing)},t.prototype.onReset=function(){var e=this;Object.keys(this.group.controls).forEach(function(t){e.group.get(t).setValue(e._pageCopy[t])})},t.prototype.onSubmit=function(t){this.onAssign(t)},t.prototype.onAssign=function(e){var o=this;Object.keys(this.group.controls).forEach(function(t){switch(t){case"description":o._page[t]=o.markdownService.compile(e[t]);break;default:o._page[t]=e[t]}})},t.decorators=[{type:s.Component,args:[{selector:"core-editor",template:'<ng-container>\n\t<div class="page--editor" [@openClose]="editing ? \'open\' : \'closed\'" (clickOutside)="editing = false">\n\t\t<ng-container *ngIf="editing && page">\n\t\t\t<form class="form" name="group" [formGroup]="group" (ngSubmit)="group.valid && onSubmit(group.value)" #form="ngForm" role="form" novalidate autocomplete="off">\n\t\t\t\t<div class="info">\n\t\t\t\t\t<span class="id">{{page.id}}</span>\n\t\t\t\t\t<span class="status" [ngClass]="{ active: page.active }">{{page.active ? \'active\' : \'inactive\'}}</span>\n\t\t\t\t\t<span class="component">{{componentName}}</span>\n\t\t\t\t</div>\n\t\t\t\t<hr>\n\t\t\t\t<h2 class="h1" [innerHTML]="page.title"></h2>\n\t\t\t\t\x3c!--\n\t\t\t\t<p [innerHTML]="page.description"></p>\n\t\t\t\t--\x3e\n\t\t\t\t<hr>\n\t\t\t\t\x3c!--\n\t\t\t\t<div class="fieldset">\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Label</label>\n\t\t\t\t\t\t<input placeholder="placeholder" type="text" class="form-control" required [(ngModel)]="model.title" name="title" #title="ngModel" autocomplete="title">\n\t\t\t\t\t\t<div *ngIf="title.invalid && (form.submitted || title.dirty || title.touched)" class="alert alert-danger">\n\t\t\t\t\t\t\t<div *ngIf="title.errors.required">{{ \'errors.required\' | translate }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t--\x3e\n\t\t\t\t<div *ngFor="let control of controls">\n\t\t\t\t\t<core-control [control]="control" [form]="group"></core-control>\n\t\t\t\t</div>\n\t\t\t\t\x3c!-- <control-editable formControlName="email"></control-editable> --\x3e\n\t\t\t\t<div class="action-bar">\n\t\t\t\t\t<button type="text" class="btn btn--dimmed" [disabled]="submitted || !group.valid" (click)="onReset()" title="Annulla"><span>Annulla</span></button>\n\t\t\t\t\t<button type="submit" class="btn btn-primary" [disabled]="submitted || !group.valid" [ngClass]="{ \'btn--busy\': busy }" title="Salva"><span>Salva</span></button>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t</ng-container>\n\t</div>\n</ng-container>\n',animations:[r.trigger("openClose",[r.state("open",r.style({opacity:1,transform:"translateX(0)"})),r.state("closed",r.style({opacity:.5,transform:"translateX(100%)"})),r.transition("open => closed",[r.animate("250ms")]),r.transition("closed => open",[r.animate("150ms")])])],encapsulation:s.ViewEncapsulation.Emulated,styles:[":host form{margin:0}:host label{display:block;width:100%;color:#55555a;font-weight:700;font-size:12px}.page--editor{position:fixed;top:0;right:0;width:320px;height:100vh;padding:15px;overflow-x:hidden;overflow-y:auto;font-family:Arial,Helvetica,sans-serif;font-size:16px;line-height:1.5;background:#fafafa;color:#55555a}.page--editor .h1{color:#55555a}@media (max-width:1024px){.page--editor{display:none}}.id{display:inline-block;padding:4px 6px;background:#0875c2;color:#fff;border-radius:3px;font-size:12px;line-height:1;margin-right:4px}.status{display:inline-block;padding:4px 6px;background:#fff;color:#000;border-radius:3px;font-size:12px;line-height:1;margin-right:4px}.status.active{background:green;color:#fff}.component{display:inline-block;font-size:14px;font-style:italic}::-webkit-scrollbar{width:0}::-webkit-scrollbar-track{background:0 0}::-webkit-scrollbar-thumb{background:0 0}::-webkit-scrollbar-thumb:hover{background:0 0}"]}]}],t.ctorParameters=function(){return[{type:String,decorators:[{type:s.Inject,args:[s.PLATFORM_ID]}]},{type:l.ConfigService},{type:p.MarkdownService},{type:l.FormService},{type:l.PageResolverService}]},t.propDecorators={onKeydown:[{type:s.HostListener,args:["document:keydown",["$event"]]}]},t}(l.DisposableComponent),u={},g=function(){function t(t){if(t)throw new Error("EditorModule is already loaded. Import it in the AppModule only")}return t.decorators=[{type:s.NgModule,args:[{imports:[i.CommonModule,e.HttpClientModule,o.FormsModule,o.ReactiveFormsModule,p.MarkdownModule.forRoot({markedOptions:{provide:p.MarkedOptions,useValue:u}}),l.CoreModule],declarations:[n,a],exports:[n,a],providers:[]}]}],t.ctorParameters=function(){return[{type:t,decorators:[{type:s.Optional},{type:s.SkipSelf}]}]},t}();t.HTTP_INTERCEPTORS=e.HTTP_INTERCEPTORS,t.FormsModule=o.FormsModule,t.ReactiveFormsModule=o.ReactiveFormsModule,t.CommonModule=i.CommonModule,t.NgModule=s.NgModule,t.Optional=s.Optional,t.SkipSelf=s.SkipSelf,t.Type=s.Type,t.MarkdownModule=p.MarkdownModule,t.MarkedOptions=p.MarkedOptions,t.EditorModuleComponent=n,t.EditorModule=g,t.EditorComponent=a,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=designr-editor.umd.min.js.map