{"version":3,"sources":["ng://@designr/core/lib/storage/storage.service.ts","ng://@designr/core/lib/auth/auth.service.ts","ng://@designr/core/lib/bundle/bundle.ts","ng://@designr/core/lib/config/core.config.ts","ng://@designr/core/lib/config/core.service.ts","ng://@designr/core/lib/content/default-content.directive.ts","ng://@designr/core/lib/core-module.component.ts","node_modules/tslib/tslib.es6.js","ng://@designr/core/lib/bundle/bundle.directive.ts","ng://@designr/core/lib/disposable/disposable.component.ts","ng://@designr/core/lib/highlight/highlight.pipe.ts","ng://@designr/core/lib/logger/logger.ts","ng://@designr/core/lib/pipes/segment.pipe.ts","ng://@designr/core/lib/api/api.service.ts","ng://@designr/core/lib/translate/translate.service.ts","ng://@designr/core/lib/route/route.service.ts","ng://@designr/core/lib/http/http-status-code.service.ts","ng://@designr/core/lib/http/http-response.interceptor.ts","ng://@designr/core/lib/json-formatter/json-formatter.component.ts","ng://@designr/core/lib/label/label.service.ts","ng://@designr/core/lib/label/label.directive.ts","ng://@designr/core/lib/label/label.pipe.ts","ng://@designr/core/lib/logger/logger.component.ts","ng://@designr/core/lib/models/event-dispatcher.service.ts","ng://@designr/core/lib/models/identity.service.ts","ng://@designr/core/lib/models/entity.service.ts","ng://@designr/core/lib/models/menu.service.ts","ng://@designr/core/lib/once/once.service.ts","ng://@designr/core/lib/outlet/outlet-default.component.ts","ng://@designr/core/lib/outlet/outlet-repeater.component.ts","ng://@designr/core/lib/outlet/outlet.ts","ng://@designr/core/lib/outlet/outlet-resolver.service.ts","ng://@designr/core/lib/outlet/outlet.component.ts","ng://@designr/core/lib/pipes/asset.pipe.ts","ng://@designr/core/lib/pipes/custom-async.pipe.ts","ng://@designr/core/lib/models/image.ts","ng://@designr/core/lib/pipes/image-url.pipe.ts","ng://@designr/core/lib/pipes/image.pipe.ts","ng://@designr/core/lib/pipes/public.pipe.ts","ng://@designr/core/lib/route/route.pipe.ts","ng://@designr/core/lib/slug/slug.service.ts","ng://@designr/core/lib/slug/slug.pipe.ts","ng://@designr/core/lib/translate/translate.directive.ts","ng://@designr/core/lib/translate/translate.pipe.ts","ng://@designr/core/lib/trust/safe-style.pipe.ts","ng://@designr/core/lib/trust/safe-url.pipe.ts","ng://@designr/core/lib/trust/trust.pipe.ts","ng://@designr/core/lib/core.module.ts","ng://@designr/core/lib/label/label.ts","ng://@designr/core/lib/models/document.ts","ng://@designr/core/lib/models/document.service.ts","ng://@designr/core/lib/models/entity.ts","ng://@designr/core/lib/models/feature.ts","ng://@designr/core/lib/models/identity.ts","ng://@designr/core/lib/models/menu-item.ts","ng://@designr/core/lib/models/taxonomy.ts","ng://@designr/core/lib/translate/translate.ts"],"names":["StorageService","prototype","delete","name","exist","get","set","value","days","on","of","tryGet","this","Injectable","args","providedIn","CookieStorageService","platformId","storageService","isSupported","setter","document","cookie","indexOf","cookieName","ca","split","i","length","c","charAt","substring","model","JSON","parse","decodeURIComponent","atob","e","console","log","cache_1","json","stringify","key","push","btoa","encodeURIComponent","interval","timeout","elapsed","checkCookie","setTimeout","expires","date","Date","setTime","getTime","toUTCString","isPlatformBrowser","Inject","PLATFORM_ID","SessionStorageService","cookieStorageService","window","sessionStorage","removeItem","undefined","cache_2","setItem","supported","LocalStorageService","localStorage","cache_3","Bearer","Cookie","AuthToken","accessToken","expiresIn","AuthService","injector","localStorageService","cachedRequests","paths","setToken","authToken","retryFailedRequests","getToken","getFakeToken","isValid","now","isAuthenticated","collectFailedRequest","request","Injector","BUNDLES","InjectionToken","CoreTransitionConfig","options","Object","assign","CoreConfig","assets","authStrategy","AuthStrategy","defaultLanguage","defaultMarket","languages","id","lang","origin","production","public","urlStrategy","useLang","useMarket","transition","CORE_CONFIG","CoreService","decorators","type","DefaultContentDirective","element","container","renderer","hasContent","nativeElement","ngAfterContentChecked","childNodes","node","nodeType","clear","createEmbeddedView","default","Directive","selector","ElementRef","ViewContainerRef","Renderer2","Input","CoreModuleComponent","version","ngOnInit","Component","template","extendStatics","d","b","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","constructor","create","__read","o","n","m","Symbol","iterator","r","call","ar","next","done","error","__spread","arguments","concat","BundleDirective","bundles","loader","_this","load","bundle","then","moduleFactory","moduleRef","rootComponentType","moduleRef_","factory","componentFactoryResolver","resolveComponentFactory","componentRef","createComponent","instance","componentRef_","ngOnDestroy","destroy","NgModuleFactoryLoader","DisposableComponent","unsubscribe","Subject","complete","HighlightPipe","transform","text","query","encodeHTML","regExp","RegExp","escapeRegexChars","replace","match","toLowerCase","safeToString","toString","trim","Pipe","_super","LoggerError","tslib_1.__extends","HttpErrorResponse","Logger","coreService","logs","_i","s","join","apply","warn","http","httpError","message","status","statusText","url","SegmentPipe","location","segments","path","isArray","normalize","Location","ApiRequestOptions","headers","HttpHeaders","Content-Type","params","HttpParams","ApiService","defineProperty","_logger","_http","HttpClient","_state","TransferState","_platformId","_config","_origin","config","base","collection","getUrl","method","first","second","pipe","tap","x","logger","post","third","put","patch","identity","toCamelCase","input","output","keyCamelCase","map","slice","getStateKey","flatMap","substr","keys","k","makeStateKey","stateGet","stateKey","state","hasKey","cached","remove","isPlatformServer","onSerialize","statePost","TranslateService","events","EventEmitter","language_","BehaviorSubject","languages_","cache_","lang_","getValue","language","find","observe$","filter","switchMap","getTranslation","labels","emit","getTranslate","defaultValue","shift","parseTranslate","missingTranslate","parseParams","missingHandler","replacer","use","setDefaultLang","addLangs","getBrowserLang","getFirstBrowserLang","getFirstBrowserLocale","navigator","properties","RouteService","translateService","route","router","segment","_language","asObservable","_languages","pageParams$","currentMarket","setLanguages","subscribeToRouter","_lang","getPageParams","queryParams","distinctUntilChanged","parsed","forEach","serializeParams","serialized","serialize","base64","Buffer","from","_a","object","getId","snapshot","paramMap","getSlug","toRoute","data","market","marketIndex","splice","langIndex","toSlug","datas","toParams","toData","setLanguage","silent","replaceState","navigate","event","NavigationStart","subscribe","lang_1","detectLanguage","acceptLanguage","detectedLanguage","regexp","performance","time","process","hrtime","start","startTime","end","endTime","ActivatedRoute","Router","HttpStatusCodeService","statusCode","redirectUrl","setStatusCode","getStatusCode","getRedirectUrl","HttpResponseInterceptor","statusCodeService","_router","_routeService","routeService","intercept","handle","catchError","throwError","JsonFormatterComponent","ngOnChanges","isObject","elementRef","removeChild","JSONFormatter","render","appendChild","encapsulation","ViewEncapsulation","Emulated","ViewChild","LabelService","values$","emitter$","values","parseLabel","enumerable","writable","transform$","debounceTime","collect$","keys_1","reduce","getLabel","label","getMissingLabel","LabelDirective","labelService","innerHTML","labelParams","takeUntil","LabelPipe","pure","LoggerComponent","EventDispatcherService","emitter","observe","IdentityService","getDetailById","EntityService","getDetailByName","MenuService","OnceService","zone","uid","script","callback","Event","callbackName_1","callback$","createElement","Promise","resolve","reject","async","fromEvent","scripts","getElementsByTagName","parentNode","insertBefore","nextSibling","src","NgZone","OutletDefaultComponent","OutletRepeaterComponent","OUTLETS","Outlet","OutletResolverService","outlets","outlet","component","OutletComponent","outletResolverService","viewContainerRef","ComponentFactoryResolver","read","AssetPipe","unshift","CustomAsyncPipe","changeDetector","subject","subscription","cachedValue","observableToValue","dispose","markForCheck","WrappedValue","wrap","_observableToValue","ChangeDetectorRef","Default","Gallery","Share","Image","ImageUrlPipe","images","queryString","imageType","ImageType","image","ImagePipe","transform__","PublicPipe","RoutePipe","SlugService","mnemonic","items","slug","slugs","SlugPipe","slugService","routePipe","TranslateDirective","translate","translateParams","TranslatePipe","ref","SafeStylePipe","sanitizer","style","bypassSecurityTrustStyle","DomSanitizer","SafeUrlPipe","bypassSecurityTrustResourceUrl","TrustPipe","bypassSecurityTrustHtml","services","components","directives","pipes","validators","CoreModule","parentModule","forRoot","ngModule","providers","provide","useValue","NgModule","imports","CommonModule","HttpClientModule","FormsModule","ReactiveFormsModule","HTTP_INTERCEPTORS","useClass","multi","SystemJsNgModuleLoader","declarations","entryComponents","exports","Optional","SkipSelf","Label","Document","DocumentIndex","DocumentService","getDetailBySlug","Entity","Feature","readmore","Identity","MenuItem","item","Taxonomy","Translate"],"mappings":"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","sourcesContent":["import { isPlatformBrowser } from '@angular/common';\nimport { Inject, Injectable, PLATFORM_ID } from '@angular/core';\nimport { Observable, of } from 'rxjs';\n\nconst TIMEOUT = 5 * 60 * 1000; // five minutes\n\n/*\nexport class StorageEvent extends Event {}\n\nexport class CookieStorageEvent extends StorageEvent { }\n\nexport class SessionStorageEvent extends StorageEvent { }\n\nexport class LocalStorageEvent extends StorageEvent { }\n*/\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class StorageService {\n\tpublic delete(name: string): void { }\n\tpublic exist(name: string): boolean { return false; }\n\tpublic get(name: string): any { return null; }\n\tpublic set(name: string, value: any, days?: number): void { }\n\tpublic on(): Observable<any> { return of(null); }\n\tpublic tryGet(): StorageService {\n\t\t// console.log('no StorageService available...');\n\t\treturn this;\n\t}\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class CookieStorageService implements StorageService {\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t\tprivate storageService: StorageService,\n\t) { }\n\n\tpublic tryGet(): StorageService {\n\t\tif (this.isSupported()) {\n\t\t\t// console.log('CookieStorageService.supported');\n\t\t\treturn this;\n\t\t} else {\n\t\t\treturn this.storageService.tryGet();\n\t\t}\n\t}\n\n\tpublic delete(name: string): void {\n\t\tthis.setter(name, '', -1);\n\t}\n\n\tpublic exist(name: string): boolean {\n\t\treturn document.cookie.indexOf(';' + name + '=') !== -1 || document.cookie.indexOf(name + '=') === 0;\n\t}\n\n\tpublic get(name: string): any {\n\t\tconst cookieName = name + '=';\n\t\tconst ca = document.cookie.split(';');\n\t\tfor (let i = 0; i < ca.length; i++) {\n\t\t\tlet c = ca[i];\n\t\t\twhile (c.charAt(0) === ' ') {\n\t\t\t\tc = c.substring(1, c.length);\n\t\t\t}\n\t\t\tif (c.indexOf(cookieName) === 0) {\n\t\t\t\tconst value = c.substring(cookieName.length, c.length);\n\t\t\t\tlet model = null;\n\t\t\t\ttry {\n\t\t\t\t\tmodel = JSON.parse(decodeURIComponent(atob(value)));\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.log('Cookie.get.error parsing', name, e);\n\t\t\t\t}\n\t\t\t\treturn model;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tpublic set(name: string, value: any, days?: number) {\n\t\ttry {\n\t\t\tlet cache = [];\n\t\t\tconst json = JSON.stringify(value, function (key, value) {\n\t\t\t\tif (key === 'pool') {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t// throw (new Error('circular reference found, discard key'));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tcache.push(value);\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t});\n\t\t\tcache = null;\n\t\t\tthis.setter(name, btoa(encodeURIComponent(json)), days);\n\t\t} catch (e) {\n\t\t\tconsole.log('CookieSet.error serializing', name, value, e);\n\t\t}\n\t}\n\n\tpublic on(): Observable<any> {\n\t\t// todo\n\t\tconst interval: number = 1000, timeout: number = TIMEOUT;\n\t\tlet i, elapsed: number = 0;\n\t\tfunction checkCookie() {\n\t\t\tif (elapsed > timeout) {\n\t\t\t\t// promise.reject('timeout');\n\t\t\t} else {\n\t\t\t\tconst c: any = this.get(name);\n\t\t\t\tif (c) {\n\t\t\t\t\t// promise.resolve(c);\n\t\t\t\t} else {\n\t\t\t\t\telapsed += interval;\n\t\t\t\t\ti = setTimeout(checkCookie, interval);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcheckCookie();\n\t\treturn of(null);\n\t}\n\n\tprivate setter(name: string, value: any, days?: number) {\n\t\tlet expires;\n\t\tif (days) {\n\t\t\tconst date = new Date();\n\t\t\tdate.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n\t\t\texpires = '; expires=' + date.toUTCString();\n\t\t} else {\n\t\t\texpires = '';\n\t\t}\n\t\tdocument.cookie = name + '=' + value + expires + '; path=/';\n\t}\n\n\tprivate isSupported(): boolean {\n\t\treturn isPlatformBrowser(this.platformId);\n\t}\n\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class SessionStorageService implements StorageService {\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t\tprivate cookieStorageService: CookieStorageService,\n\t) { }\n\n\tpublic tryGet(): StorageService {\n\t\tif (this.isSupported()) {\n\t\t\t// console.log('SessionStorageService.supported');\n\t\t\treturn this;\n\t\t} else {\n\t\t\treturn this.cookieStorageService.tryGet();\n\t\t}\n\t}\n\n\tpublic delete(name: string): void {\n\t\twindow.sessionStorage.removeItem(name);\n\t}\n\n\tpublic exist(name: string): boolean {\n\t\treturn window.sessionStorage[name] !== undefined;\n\t}\n\n\tpublic get(name: string): any {\n\t\tlet value = null;\n\t\tif (window.sessionStorage[name] !== undefined) {\n\t\t\ttry {\n\t\t\t\tvalue = JSON.parse(window.sessionStorage[name]);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('SessionStorage.get.error parsing', name, e);\n\t\t\t}\n\t\t}\n\t\treturn value;\n\t}\n\n\tpublic on(): Observable<any> {\n\t\t/*\n\t\treturn $promise(function (promise) {\n\t\t\tconst timeout = TIMEOUT;\n\t\t\tlet i;\n\t\t\tfunction storageEvent(e) {\n\t\t\t\tif (i) {\n\t\t\t\t\tclearTimeout(i);\n\t\t\t\t}\n\t\t\t\tif (e.originalEvent.key === name) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlet value = JSON.parse(e.originalEvent.newValue);\n\t\t\t\t\t\tpromise.resolve(value);\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tconsole.log('SessionStorage.on.error parsing', name, error);\n\t\t\t\t\t\tpromise.reject('error parsing ' + name);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// return fromEvent(window, 'storage');\n\t\t\tangular.element(window).on('storage', storageEvent);\n\t\t\ti = setTimeout(function () {\n\t\t\t\tpromise.reject('timeout');\n\t\t\t}, timeout);\n\t\t});\n\t\t*/\n\t\treturn of(null);\n\t}\n\n\tpublic set(name: string, value: any, days?: number): void {\n\t\ttry {\n\t\t\tlet cache = [];\n\t\t\tconst json = JSON.stringify(value, function (key, value) {\n\t\t\t\tif (key === 'pool') {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t// throw (new Error('circular reference found, discard key'));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tcache.push(value);\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t});\n\t\t\tcache = null;\n\t\t\twindow.sessionStorage.setItem(name, json);\n\t\t} catch (e) {\n\t\t\tconsole.log('SessionStorage.set.error serializing', name, value, e);\n\t\t}\n\t}\n\n\tprivate isSupported(): boolean {\n\t\tlet supported: boolean = false;\n\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\ttry {\n\t\t\t\tsupported = 'sessionStorage' in window && window.sessionStorage !== null;\n\t\t\t\tif (supported) {\n\t\t\t\t\twindow.sessionStorage.setItem('test', '1');\n\t\t\t\t\twindow.sessionStorage.removeItem('test');\n\t\t\t\t} else {\n\t\t\t\t\tsupported = false;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tsupported = false;\n\t\t\t}\n\t\t}\n\t\treturn supported;\n\t}\n\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class LocalStorageService implements StorageService {\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t\tprivate cookieStorageService: CookieStorageService,\n\t) { }\n\n\tpublic tryGet(): StorageService {\n\t\tif (this.isSupported()) {\n\t\t\t// console.log('LocalStorageService.supported');\n\t\t\treturn this;\n\t\t} else {\n\t\t\treturn this.cookieStorageService.tryGet();\n\t\t}\n\t}\n\n\tpublic delete(name: string): void {\n\t\twindow.localStorage.removeItem(name);\n\t}\n\n\tpublic exist(name: string): boolean {\n\t\treturn window.localStorage[name] !== undefined;\n\t}\n\n\tpublic get(name: string): any {\n\t\tlet value = null;\n\t\tif (window.localStorage[name] !== undefined) {\n\t\t\ttry {\n\t\t\t\tvalue = JSON.parse(window.localStorage[name]);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('LocalStorage.get.error parsing', name, e);\n\t\t\t}\n\t\t}\n\t\treturn value;\n\t}\n\n\tpublic on(): Observable<any> {\n\t\t/*\n\t\treturn $promise(function (promise) {\n\t\t\tconst timeout = TIMEOUT;\n\t\t\tlet i;\n\t\t\tfunction storageEvent(e) {\n\t\t\t\tif (i) {\n\t\t\t\t\tclearTimeout(i);\n\t\t\t\t}\n\t\t\t\tif (e.originalEvent.key === name) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlet value = JSON.parse(e.originalEvent.newValue);\n\t\t\t\t\t\tpromise.resolve(value);\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tconsole.log('LocalStorage.on.error parsing', name, error);\n\t\t\t\t\t\tpromise.reject('error parsing ' + name);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// return fromEvent(window, 'storage');\n\t\t\tangular.element(window).on('storage', storageEvent);\n\t\t\ti = setTimeout(function () {\n\t\t\t\tpromise.reject('timeout');\n\t\t\t}, timeout);\n\t\t});\n\t\t*/\n\t\treturn of(null);\n\t}\n\n\tpublic set(name: string, value: any, days?: number): void {\n\t\ttry {\n\t\t\tlet cache = [];\n\t\t\tconst json = JSON.stringify(value, function (key, value) {\n\t\t\t\tif (key === 'pool') {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t// throw (new Error('circular reference found, discard key'));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tcache.push(value);\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t});\n\t\t\tcache = null;\n\t\t\twindow.localStorage.setItem(name, json);\n\t\t} catch (e) {\n\t\t\tconsole.log('LocalStorage.set.error serializing', name, value, e);\n\t\t}\n\t}\n\n\tprivate isSupported(): boolean {\n\t\tlet supported: boolean = false;\n\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\ttry {\n\t\t\t\tsupported = 'localStorage' in window && window.localStorage !== null;\n\t\t\t\tif (supported) {\n\t\t\t\t\twindow.localStorage.setItem('test', '1');\n\t\t\t\t\twindow.localStorage.removeItem('test');\n\t\t\t\t} else {\n\t\t\t\t\tsupported = false;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tsupported = false;\n\t\t\t}\n\t\t}\n\t\treturn supported;\n\t}\n\n}\n","import { HttpRequest } from '@angular/common/http';\nimport { Inject, Injectable, Injector, PLATFORM_ID } from '@angular/core';\nimport { LocalStorageService } from '../storage/storage.service';\n\nexport enum AuthStrategy {\n\tBearer = 0,\n\tCookie = 1,\n}\n\nexport class AuthToken {\n\tconstructor(\n\t\tpublic accessToken: string,\n\t\tpublic expiresIn: number = 0\n\t) { }\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class AuthService {\n\n\tprivate cachedRequests: Array<HttpRequest<any>> = [];\n\tprivate paths: string[] = [];\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t\tprivate injector: Injector,\n\t\tprivate localStorageService: LocalStorageService,\n\t) { }\n\n\tsetToken(authToken: AuthToken): void {\n\t\tthis.localStorageService.set('authToken', authToken);\n\t\tthis.retryFailedRequests();\n\t}\n\n\tgetToken(): AuthToken {\n\t\treturn this.localStorageService.get('authToken') as AuthToken;\n\t}\n\n\tgetFakeToken(): AuthToken {\n\t\treturn new AuthToken('fakeToken');\n\t}\n\n\tisValid(authToken: AuthToken): boolean {\n\t\t// return a boolean reflecting whether or not the token is expired\n\t\treturn authToken && (authToken.expiresIn > Date.now() || authToken.expiresIn === 0);\n\t}\n\n\tisAuthenticated(): boolean {\n\t\tconst authToken = this.getToken();\n\t\treturn this.isValid(authToken);\n\t}\n\n\tcollectFailedRequest(request): void {\n\t\tthis.cachedRequests.push(request);\n\t}\n\n\tretryFailedRequests(): void {\n\t\t// this method can be called after the token is refreshed\n\t\t// console.log('AuthService.retryFailedRequests');\n\t\t// retry the requests.\n\t}\n\n}\n","import { InjectionToken } from '@angular/core';\n\nexport interface Bundles { [key: string]: string; }\n\nexport const BUNDLES = new InjectionToken<Bundles>('core.bundles');\n","import { InjectionToken } from '@angular/core';\nimport { AuthStrategy } from '../auth/auth.service';\n\nexport class Language {\n\tid?: number;\n\tname?: string;\n\tlang?: string;\n}\n\nexport class CoreTransitionConfig {\n\tappId: string;\n\n\tconstructor(options?: CoreTransitionConfig) {\n\t\t// console.log('CoreTransitionConfig', options);\n\t\tif (options) {\n\t\t\tObject.assign(this, options);\n\t\t}\n\t}\n}\n\nexport class CoreConfig {\n\tassets?: string = '';\n\tauthStrategy?: AuthStrategy = AuthStrategy.Cookie;\n\tdefaultLanguage?: string = 'it';\n\tdefaultMarket?: string = 'it';\n\tlanguages?: Language[] = [{ id: 1, name: 'Italiano', lang: 'it' }];\n\torigin?: string = '';\n\tproduction?: boolean = false;\n\tpublic?: string = '';\n\ttransition?: CoreTransitionConfig;\n\turlStrategy?: string = '';\n\tuseLang?: boolean = false;\n\tuseMarket?: boolean = false;\n\tuseServiceWorker?: boolean;\n\trouting?: any; // ExtraOptions\n\n\tconstructor(options?: CoreConfig) {\n\t\t// console.log('CoreConfig', options);\n\t\tif (options) {\n\t\t\tObject.assign(this, options);\n\t\t\tthis.transition = new CoreTransitionConfig(options.transition);\n\t\t} else {\n\t\t\tthis.transition = new CoreTransitionConfig();\n\t\t}\n\t}\n}\n\nexport const CORE_CONFIG = new InjectionToken<CoreConfig>('core.config');\n","\nimport { Inject, Injectable } from '@angular/core';\nimport { CoreConfig, CORE_CONFIG } from './core.config';\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class CoreService {\n\n\tpublic options: CoreConfig;\n\n\tconstructor(\n\t\t@Inject(CORE_CONFIG) options: CoreConfig\n\t) {\n\t\t// console.log('CoreService', options);\n\t\toptions = options || {};\n\t\t// options.defaultPage = (options.defaultPage || PageNotFoundComponent) as Type<PageComponent>;\n\t\t// options.notFoundPage = (options.notFoundPage || PageNotFoundComponent) as Type<PageComponent>;\n\t\tthis.options = new CoreConfig(options);\n\t}\n\n}\n","import { AfterContentChecked, Directive, ElementRef, Input, Renderer2, TemplateRef, ViewContainerRef } from '@angular/core';\n\n@Directive({\n\tselector: '[default]',\n})\nexport class DefaultContentDirective implements AfterContentChecked {\n\n\t@Input() default: TemplateRef<any>;\n\tprivate element: HTMLElement;\n\tprivate hasContent = true;\n\n\tconstructor(\n\t\telement: ElementRef,\n\t\tprivate container: ViewContainerRef,\n\t\tprivate renderer: Renderer2) {\n\t\tthis.element = element.nativeElement;\n\t}\n\n\tngAfterContentChecked(): void {\n\t\tlet hasContent = false;\n\t\tconsole.log('DefaultContentDirective', this.element.childNodes);\n\t\tfor (let i = this.element.childNodes.length - 1; i >= 0; --i) {\n\t\t\tconst node = this.element.childNodes[i];\n\t\t\tif (node.nodeType === 1 || node.nodeType === 3) {\n\t\t\t\thasContent = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (hasContent !== this.hasContent) {\n\t\t\tthis.hasContent = hasContent;\n\t\t\tif (hasContent) {\n\t\t\t\t// this.renderer.removeClass(this.element, 'is-empty');\n\t\t\t\tthis.container.clear();\n\t\t\t} else {\n\t\t\t\t// this.renderer.addClass(this.element, 'is-empty');\n\t\t\t\tthis.container.createEmbeddedView(this.default);\n\t\t\t}\n\t\t}\n\t}\n\n}\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n\tselector: 'core-module',\n\ttemplate: `<span class=\"core-module\">core {{version}}</span>`,\n\tstyles: []\n})\nexport class CoreModuleComponent implements OnInit {\n\n\tversion: string = '0.0.11';\n\n\tconstructor() { }\n\n\tngOnInit() {\n\t}\n\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import { ComponentRef, Directive, Inject, Injector, Input, NgModuleFactory, NgModuleFactoryLoader, NgModuleRef, OnDestroy, OnInit, Type, ViewContainerRef } from '@angular/core';\nimport { Bundles, BUNDLES } from './bundle';\n\nexport type ModuleWithRoot = Type<any> & { rootComponent: Type<any> };\n\n@Directive({\n\tselector: '[bundle]'\n})\nexport class BundleDirective implements OnInit, OnDestroy {\n\n\t@Input() bundle: keyof Bundles;\n\t@Input() data?: any;\n\tprivate moduleRef_: NgModuleRef<any>;\n\tprivate componentRef_: ComponentRef<any>;\n\n\tconstructor(\n\t\t@Inject(BUNDLES) private bundles,\n\t\tprivate injector: Injector,\n\t\tprivate loader: NgModuleFactoryLoader,\n\t\tprivate container: ViewContainerRef,\n\t) {\n\t}\n\n\tngOnInit() {\n\t\tthis.loader.load(this.bundles[this.bundle]).then((moduleFactory: NgModuleFactory<any>) => {\n\t\t\tconst moduleRef = moduleFactory.create(this.injector);\n\t\t\tthis.moduleRef_ = moduleRef;\n\t\t\tconst rootComponentType = moduleRef.injector.get('LAZY_ROOT_COMPONENT');\n\t\t\t// console.log(rootComponentType);\n\t\t\tconst factory = moduleRef.componentFactoryResolver.resolveComponentFactory(rootComponentType);\n\t\t\tconst componentRef = this.container.createComponent(factory);\n\t\t\tconst instance = componentRef.instance;\n\t\t\t// instance.data = this.data; // !!!\n\t\t\tthis.componentRef_ = componentRef;\n\t\t});\n\t}\n\n\tngOnDestroy() {\n\t\tif (this.componentRef_) {\n\t\t\tthis.componentRef_.destroy();\n\t\t}\n\t\tif (this.moduleRef_) {\n\t\t\tthis.moduleRef_.destroy();\n\t\t}\n\t}\n\n}\n","\nimport { Component, OnDestroy } from '@angular/core';\nimport { Subject } from 'rxjs';\n\n@Component({\n\ttemplate: ''\n})\nexport class DisposableComponent implements OnDestroy {\n\n\tprotected unsubscribe: any = new Subject();\n\n\tngOnDestroy() {\n\t\tthis.unsubscribe.next();\n\t\tthis.unsubscribe.complete();\n\t\t// console.log('DisposableComponent.ngOnDestroy', this);\n\t}\n\n}\n","import { Injectable, Pipe, PipeTransform } from '@angular/core';\n\n@Pipe({\n\tname: 'highlight',\n\t// pure: false\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class HighlightPipe implements PipeTransform {\n\n\ttransform(text: string, query: string): string {\n\t\tif (!query) {\n\t\t\treturn text;\n\t\t}\n\t\ttext = this.encodeHTML(text);\n\t\tquery = this.encodeHTML(query);\n\t\tconst regExp = new RegExp('&[^;]+;|' + this.escapeRegexChars(query), 'gi');\n\t\treturn text.replace(regExp, function (match) {\n\t\t\treturn match.toLowerCase() === query.toLowerCase() ? '<strong>' + match + '</strong>' : match;\n\t\t});\n\t}\n\n\tescapeRegexChars(text: string) {\n\t\treturn text.replace(/([.?*+^$[\\]\\\\(){}|-])/g, '\\\\$1');\n\t}\n\n\tsafeToString(text: string) {\n\t\treturn text === undefined || text === null ? '' : text.toString().trim();\n\t}\n\n\tencodeHTML(text: string) {\n\t\treturn this.safeToString(text)\n\t\t\t.replace(/&/g, '&amp;')\n\t\t\t.replace(/</g, '&lt;')\n\t\t\t.replace(/>/g, '&gt;');\n\t}\n\n}\n","import { HttpErrorResponse } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { CoreService } from '../config/core.service';\n\nexport class LoggerError extends HttpErrorResponse {\n\tbody?: any;\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class Logger {\n\n\thttpError: LoggerError;\n\tlogs: string[] = [];\n\n\tconstructor(\n\t\tprivate coreService: CoreService,\n\t) {\n\t\t//\n\t}\n\n\trequest(...args: any[]) {\n\t\tif (!this.coreService.options.production) {\n\t\t\tconst s = args.join(', ');\n\t\t\tthis.logs.push(s);\n\t\t\t// console.log.apply(this, ['%c %s', 'background: #dddddd; color: #111'].concat(args));\n\t\t}\n\t}\n\n\tlog(...args: any[]) {\n\t\tif (!this.coreService.options.production) {\n\t\t\tconst s = args.join(', ');\n\t\t\tthis.logs.push(s);\n\t\t\tconsole.log.apply(this, ['%c%s', 'background: #1976d2; color: #fff; border-radius: 3px; padding: 4px 8px; margin-bottom: 4px;'].concat(args));\n\t\t}\n\t}\n\n\twarn(...args: any[]) {\n\t\tif (!this.coreService.options.production) {\n\t\t\tconst s = args.join(', ');\n\t\t\tthis.logs.push(s);\n\t\t\tconsole.log.apply(this, ['%c%s', 'background: #ff5500; color: #fff'].concat(args));\n\t\t}\n\t}\n\n\terror(...args: any[]) {\n\t\tif (!this.coreService.options.production) {\n\t\t\tconst s = args.join(', ');\n\t\t\tthis.logs.push(s);\n\t\t\tconsole.error.apply(console, args);\n\t\t}\n\t}\n\n\thttp(error: HttpErrorResponse) {\n\t\tthis.httpError = error;\n\t\tif (!this.coreService.options.production) {\n\t\t\tthis.logs.push(error.message);\n\t\t}\n\t\tconsole.warn('Logger.http.error', error.status, error.statusText, error.url);\n\t}\n\n\tclear() {\n\t\tthis.httpError = null;\n\t\tthis.logs = [];\n\t}\n}\n","\nimport { Location } from '@angular/common';\nimport { Injectable, Pipe, PipeTransform } from '@angular/core';\n\n@Pipe({\n\tname: 'segment',\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class SegmentPipe implements PipeTransform {\n\n\tconstructor(\n\t\tprivate location: Location\n\t) { }\n\n\ttransform(segments: any[] | string): any[] {\n\t\tsegments = segments != null ? (Array.isArray(segments) ? segments : segments.split('/')) : [];\n\t\tlet path: string = segments.join('/');\n\t\tpath = this.location.normalize(path);\n\t\tif (path.indexOf('/') !== 0) {\n\t\t\tpath = `/${path}`;\n\t\t}\n\t\tsegments = path.split('/');\n\t\treturn segments;\n\t}\n\n}\n","import { isPlatformBrowser, isPlatformServer } from '@angular/common';\nimport { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable, Injector, PLATFORM_ID } from '@angular/core';\nimport { makeStateKey, StateKey, TransferState } from '@angular/platform-browser';\nimport { Observable, of } from 'rxjs';\nimport { tap } from 'rxjs/operators';\nimport { CoreConfig } from '../config/core.config';\nimport { CoreService } from '../config/core.service';\nimport { Logger } from '../logger/logger';\n\nexport class ApiRequestOptions {\n\theaders?: HttpHeaders;\n\tparams?: HttpParams;\n\tconstructor(options?: {}) {\n\t\tthis.headers = new HttpHeaders({\n\t\t\t'Content-Type': 'application/json'\n\t\t});\n\t\tthis.params = options ? new HttpParams(options) : null;\n\t}\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class ApiService<T> {\n\n\tget collection(): string {\n\t\treturn '/api';\n\t}\n\n\tprivate _logger: Logger;\n\tget logger(): Logger {\n\t\tif (!this._logger) {\n\t\t\tthis._logger = this.injector.get(Logger);\n\t\t}\n\t\treturn this._logger;\n\t}\n\n\tprivate _http: HttpClient;\n\tget http(): HttpClient {\n\t\tif (!this._http) {\n\t\t\tthis._http = this.injector.get(HttpClient);\n\t\t}\n\t\treturn this._http;\n\t}\n\n\tprivate _state: TransferState;\n\tget state(): TransferState {\n\t\tif (!this._state) {\n\t\t\tthis._state = this.injector.get(TransferState);\n\t\t}\n\t\treturn this._state;\n\t}\n\n\tprivate _platformId: string;\n\tget platformId(): string {\n\t\tif (!this._platformId) {\n\t\t\tthis._platformId = this.injector.get<string>(PLATFORM_ID);\n\t\t}\n\t\treturn this._platformId;\n\t}\n\n\tprivate _config: CoreConfig;\n\tget config(): CoreConfig {\n\t\tif (!this._config) {\n\t\t\tthis._config = this.injector.get(CoreService).options;\n\t\t}\n\t\treturn this._config;\n\t}\n\n\tprivate _origin: string;\n\tget origin(): string {\n\t\tif (!this._origin) {\n\t\t\tthis._origin = this.config.origin;\n\t\t}\n\t\treturn this._origin;\n\t}\n\n\tget url(): string {\n\t\tlet base: string = this.origin;\n\t\tconst collection = this.collection.toLowerCase();\n\t\tif (collection.indexOf('http') === 0) {\n\t\t\tbase = '';\n\t\t}\n\t\treturn `${base}${collection}`;\n\t}\n\n\tconstructor(\n\t\tprotected injector: Injector\n\t) { }\n\n\tgetUrl(method: string = ''): string {\n\t\treturn `${this.url}${method}`;\n\t}\n\n\tget(first?: string | {}, second?: {}): Observable<any> {\n\t\tconst method: string = (typeof first === 'string' ? first : '');\n\t\tconst params: {} = (typeof first === 'object' ? first : second);\n\t\tconst url: string = this.getUrl(method);\n\t\tconst options = new ApiRequestOptions(params);\n\t\treturn this.http.get<T[]>(url, options).pipe(\n\t\t\ttap(x => this.logger.request(url)),\n\t\t);\n\t}\n\n\tpost(first: string | {}, second?: {}, third?: {}): Observable<any> {\n\t\tconst method: string = (typeof first === 'string' ? first : '');\n\t\tconst model: {} = (typeof first === 'object' ? first : second);\n\t\tconst params: {} = (typeof second === 'object' ? second : third);\n\t\tconst url: string = this.getUrl(method);\n\t\tconst options = new ApiRequestOptions(params);\n\t\treturn this.http.post<T>(url, model, options).pipe(\n\t\t\ttap(x => this.logger.request(url)),\n\t\t);\n\t}\n\n\tput(first: string | T, second?: T | {}, third?: {}): Observable<any> {\n\t\tconst method: string = (typeof first === 'string' ? first : '');\n\t\tconst model: T = (typeof first === 'object' ? first : second) as T;\n\t\tconst params: {} = (typeof second === 'object' ? second : third);\n\t\tconst url: string = this.getUrl(method);\n\t\tconst options = new ApiRequestOptions(params);\n\t\treturn this.http.put<T>(url, model, options).pipe(\n\t\t\ttap(x => this.logger.request(url)),\n\t\t);\n\t}\n\n\tpatch(first: string | T, second?: T | {}, third?: {}): Observable<any> {\n\t\tconst method: string = (typeof first === 'string' ? first : '');\n\t\tconst model: T = (typeof first === 'object' ? first : second) as T;\n\t\tconst params: {} = (typeof second === 'object' ? second : third);\n\t\tconst url: string = this.getUrl(method);\n\t\tconst options = new ApiRequestOptions(params);\n\t\treturn this.http.patch<T>(url, model, options).pipe(\n\t\t\ttap(x => this.logger.request(url)),\n\t\t);\n\t}\n\n\tdelete(first: string | T | number, second?: T | number | {}, third?: {}): Observable<any> {\n\t\tconst method: string = (typeof first === 'string' ? first : '');\n\t\tconst identity: T | number = (typeof first !== 'string' ? first : second) as T | number;\n\t\tconst id = identity ? (typeof identity === 'number' ? identity : (identity as any).id) : null;\n\t\tconst params: {} = (typeof second === 'object' ? second : third);\n\t\tconst url: string = id !== null ? this.getUrl(`${method}/${id}`) : this.getUrl(method);\n\t\tconst options = new ApiRequestOptions(params);\n\t\treturn this.http.delete<T[]>(url, options).pipe(\n\t\t\ttap(x => this.logger.request(url)),\n\t\t);\n\t}\n\n\ttoCamelCase(input: any): any {\n\t\tlet output, key, keyCamelCase, value;\n\t\tif (input instanceof Array) {\n\t\t\treturn input.map((value: any) => {\n\t\t\t\tif (typeof value === 'object') {\n\t\t\t\t\tvalue = this.toCamelCase(value);\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t});\n\t\t} else {\n\t\t\toutput = {};\n\t\t\tfor (key in input) {\n\t\t\t\tif (input.hasOwnProperty(key)) {\n\t\t\t\t\tkeyCamelCase = (key.charAt(0).toLowerCase() + key.slice(1) || key).toString();\n\t\t\t\t\tvalue = input[key];\n\t\t\t\t\tif (value instanceof Array || (value !== null && value.constructor === Object)) {\n\t\t\t\t\t\tvalue = this.toCamelCase(value);\n\t\t\t\t\t}\n\t\t\t\t\toutput[keyCamelCase] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t}\n\n\t// TRANSFER STATE\n\n\tgetStateKey(url: string, model: {}): StateKey<any> {\n\t\tconst flatMap = (s: string, x: any) => {\n\t\t\tif (typeof x === 'number') {\n\t\t\t\ts += x.toString();\n\t\t\t} else if (typeof x === 'string') {\n\t\t\t\ts += x.substr(0, 10);\n\t\t\t} else if (x && typeof x === 'object') {\n\t\t\t\ts += '_' + Object.keys(x).map(k => k + '_' + flatMap('', x[k])).join('_');\n\t\t\t}\n\t\t\treturn s;\n\t\t};\n\t\turl = flatMap(url, model);\n\t\t// console.log('ApiService.getStateKey.url', url);\n\t\tconst key: string = url.replace(/(\\W)/gm, '_');\n\t\t// this.logger.log('ApiService.getStateKey.key', key);\n\t\treturn makeStateKey(key);\n\t}\n\n\tstateGet(first?: string | {}, second?: {}): Observable<any> {\n\t\tconst method: string = (typeof first === 'string' ? first : '');\n\t\tconst params: {} = (typeof first === 'object' ? first : second);\n\t\tconst url: string = this.getUrl(method);\n\t\tconst options = new ApiRequestOptions(params);\n\t\tconst stateKey = this.getStateKey(url, params);\n\t\tif (isPlatformBrowser(this.platformId) && this.state.hasKey(stateKey)) {\n\t\t\tconst cached = this.state.get(stateKey, null);\n\t\t\tthis.state.remove(stateKey);\n\t\t\treturn of(cached);\n\t\t} else {\n\t\t\treturn this.http.get<any>(url, options).pipe(\n\t\t\t\ttap(x => {\n\t\t\t\t\tif (isPlatformServer(this.platformId)) {\n\t\t\t\t\t\tthis.state.onSerialize(stateKey, () => x);\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\t}\n\n\tstatePost(first: string | {}, second?: {}, third?: {}): Observable<any> {\n\t\tconst method: string = (typeof first === 'string' ? first : '');\n\t\tconst model: {} = (typeof first === 'object' ? first : second);\n\t\tconst params: {} = (typeof second === 'object' ? second : third);\n\t\tconst url: string = this.getUrl(method);\n\t\tconst options = new ApiRequestOptions(params);\n\t\tconst stateKey = this.getStateKey(url, model);\n\t\tif (isPlatformBrowser(this.platformId) && this.state.hasKey(stateKey)) {\n\t\t\tconst cached = this.state.get(stateKey, null);\n\t\t\tthis.state.remove(stateKey);\n\t\t\treturn of(cached);\n\t\t} else {\n\t\t\treturn this.http.post<T>(url, model, options).pipe(\n\t\t\t\ttap(x => {\n\t\t\t\t\tif (isPlatformServer(this.platformId)) {\n\t\t\t\t\t\tthis.state.onSerialize(stateKey, () => x);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\t}\n\n}\n","import { isPlatformBrowser } from '@angular/common';\nimport { EventEmitter, Injectable, Injector } from '@angular/core';\nimport { BehaviorSubject, Observable, of } from 'rxjs';\nimport { filter, map, switchMap } from 'rxjs/operators';\nimport { ApiService } from '../api/api.service';\nimport { Translate } from './translate';\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class TranslateService<T extends Translate> extends ApiService<T> {\n\n\tget collection(): string {\n\t\treturn '/api/translate';\n\t}\n\n\tpublic events: EventEmitter<any> = new EventEmitter();\n\tpublic missingHandler?: Function;\n\n\tprivate lang_: string;\n\tprivate language_: any = new BehaviorSubject<any>(undefined);\n\tprivate languages_: BehaviorSubject<Array<any>> = new BehaviorSubject([]);\n\tprivate cache_: { [key: string]: string; } = {};\n\n\tpublic get lang(): string {\n\t\treturn this.lang_;\n\t}\n\n\tpublic set lang(lang: string) {\n\t\tif (lang !== this.lang_) {\n\t\t\tthis.lang_ = lang;\n\t\t\tconst languages = this.languages_.getValue();\n\t\t\tif (languages.length) {\n\t\t\t\tconst language = languages.find(x => x.lang === lang);\n\t\t\t\tthis.language_.next(language);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic get language() {\n\t\treturn this.language_.getValue();\n\t}\n\n\tpublic get languages() {\n\t\treturn this.languages_.getValue();\n\t}\n\n\tconstructor(\n\t\tprotected injector: Injector\n\t) {\n\t\tsuper(injector);\n\t\tthis.languages_.next(this.config.languages);\n\t}\n\n\tpublic observe$(): Observable<{}> {\n\t\treturn this.language_.pipe(\n\t\t\tfilter(x => x !== undefined),\n\t\t\tswitchMap((language: any) => this.getTranslation(language.lang)),\n\t\t);\n\t}\n\n\tpublic getTranslation(lang: string): Observable<{}> {\n\t\tif (!lang || !lang.trim()) {\n\t\t\treturn of(null);\n\t\t}\n\t\tthis.lang_ = lang;\n\t\tif (this.cache_[lang]) {\n\t\t\treturn of(this.cache_[lang]);\n\t\t} else {\n\t\t\treturn this.get(`?lang=${lang}`, { lang }).pipe(\n\t\t\t\t// take(1),\n\t\t\t\tmap((x: Translate[]) => {\n\t\t\t\t\tif (x.length && x[0]) {\n\t\t\t\t\t\tconst labels = x[0].labels;\n\t\t\t\t\t\tthis.cache_[lang] = labels;\n\t\t\t\t\t\tthis.events.emit(labels);\n\t\t\t\t\t\treturn labels;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn of(null);\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\t// tap(x => this.logger.log(`found label matching \"${lang}\"`))\n\t\t\t);\n\t\t}\n\t}\n\n\tpublic getTranslate(key: string, defaultValue?: string, params?: any): string | any {\n\t\t// console.log('TranslateService.getTranslate', key, this.cache_, this.lang_);\n\t\tif (key) {\n\t\t\tlet value: string | null = null;\n\t\t\tlet labels: any = this.cache_[this.lang_];\n\t\t\t// console.log('labels', this.lang_, this.cache_, labels);\n\t\t\tif (labels) {\n\t\t\t\tconst keys: string[] = key.split('.');\n\t\t\t\tlet k = keys.shift();\n\t\t\t\twhile (keys.length > 0 && labels[k]) {\n\t\t\t\t\tlabels = labels[k];\n\t\t\t\t\tk = keys.shift();\n\t\t\t\t}\n\t\t\t\tvalue = labels[k]; // || `{${k}}`;\n\t\t\t\tif (typeof value !== 'string') {\n\t\t\t\t\tvalue = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this.parseTranslate(value, key, defaultValue, params);\n\t\t}\n\t}\n\n\tpublic transform(key: string, defaultValue?: string, params?: any): string | undefined {\n\t\tconst value = this.getTranslate(key, defaultValue, params);\n\t\treturn value;\n\t}\n\n\tprivate parseTranslate(value: string | null, key: string, defaultValue?: string, params?: any): string | any {\n\t\tif (value == null) {\n\t\t\treturn defaultValue || this.missingTranslate(key);\n\t\t} else if (params) {\n\t\t\treturn this.parseParams(value, params);\n\t\t}\n\t\treturn value;\n\t}\n\n\tprivate missingTranslate(key: string): string {\n\t\tif (this.missingHandler) {\n\t\t\treturn typeof this.missingHandler === 'function' ?\n\t\t\t\tthis.missingHandler(key) :\n\t\t\t\tthis.missingHandler;\n\t\t}\n\t\treturn key;\n\t}\n\n\tprivate parseParams(value: string, params: any): string {\n\t\tconst TEMPLATE_REGEXP: RegExp = /@([^{}\\s]*)/g; // /{{\\s?([^{}\\s]*)\\s?}}/g;\n\t\treturn value.replace(TEMPLATE_REGEXP, (text: string, key: string) => {\n\t\t\tconst replacer: string = params[key] as string;\n\t\t\treturn typeof replacer !== 'undefined' ? replacer : text;\n\t\t});\n\t}\n\n\tpublic use(lang: string) {\n\n\t}\n\n\tpublic setDefaultLang(lang: string) {\n\n\t}\n\n\tpublic addLangs(lang: string[]) {\n\n\t}\n\n\tpublic getBrowserLang(): string {\n\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\tconst lang = this.getFirstBrowserLang() || this.config.defaultLanguage; // navigator.languages ? navigator.languages[0] : (navigator.language || navigator['userLanguage'] || this.config.defaultLanguage);\n\t\t\t// console.log('getBrowserLang', lang, navigator.languages);\n\t\t\treturn lang;\n\t\t} else {\n\t\t\treturn this.config.defaultLanguage;\n\t\t}\n\t}\n\n\tpublic getFirstBrowserLang() {\n\t\tconst lang = this.getFirstBrowserLocale();\n\t\tif (lang) {\n\t\t\treturn lang.split('-')[0];\n\t\t}\n\t}\n\n\tpublic getFirstBrowserLocale() {\n\t\tconst navigator = window.navigator;\n\t\tconst properties = ['language', 'browserLanguage', 'systemLanguage', 'userLanguage'];\n\t\tlet lang;\n\t\tif (Array.isArray(navigator.languages)) {\n\t\t\tlang = navigator.languages[0];\n\t\t}\n\t\tlet i = 0;\n\t\twhile (!lang && i < properties.length) {\n\t\t\tlang = navigator[properties[i]];\n\t\t\ti++;\n\t\t}\n\t\treturn lang;\n\t}\n\n}\n","\n\nimport { isPlatformBrowser, isPlatformServer, Location } from '@angular/common';\nimport { Inject, Injectable, Injector, PLATFORM_ID } from '@angular/core';\nimport { ActivatedRoute, NavigationStart, Params, Router } from '@angular/router';\nimport { BehaviorSubject, Observable, of } from 'rxjs';\nimport { distinctUntilChanged, filter, switchMap } from 'rxjs/operators';\nimport { CoreService } from '../config/core.service';\nimport { SegmentPipe } from '../pipes/segment.pipe';\nimport { Translate } from '../translate/translate';\nimport { TranslateService } from '../translate/translate.service';\n\ndeclare const Buffer;\ndeclare const process;\n\n// @dynamic\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class RouteService {\n\n\tstatic startTime: number;\n\tstatic endTime: number;\n\tprivate urlStrategy: string;\n\tprivate _language: any = new BehaviorSubject({});\n\tpublic readonly language: Observable<any> = this._language.asObservable();\n\tprivate _languages: BehaviorSubject<Array<any>> = new BehaviorSubject([]);\n\tpublic readonly languages: Observable<any[]> = this._languages.asObservable();\n\tprivate _lang: string;\n\tprivate path: string;\n\tpublic params: Observable<Params>;\n\tpublic queryParams: Observable<Params>;\n\tpublic currentMarket: string;\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t\tprivate coreService: CoreService,\n\t\tprivate injector: Injector,\n\t\tprivate translateService: TranslateService<Translate>,\n\t\tprivate location: Location,\n\t\tprivate route: ActivatedRoute,\n\t\tprivate router: Router,\n\t\tprivate segment: SegmentPipe,\n\t) {\n\t\tthis.urlStrategy = this.coreService.options.urlStrategy;\n\t\tthis._languages.next(this.coreService.options.languages);\n\t\tthis.currentMarket = this.coreService.options.defaultMarket;\n\t\tthis.setLanguages();\n\t\tif (this.coreService.options.useLang || this.coreService.options.useMarket) {\n\t\t\tthis.subscribeToRouter();\n\t\t}\n\t}\n\n\tprivate get lang(): string {\n\t\treturn this._lang;\n\t}\n\n\tprivate set lang(lang: string) {\n\t\tif (lang !== this._lang) {\n\t\t\tthis._lang = lang;\n\t\t\tconst language = this._languages.getValue().find(x => x.lang === lang);\n\t\t\tthis._language.next(language);\n\t\t\tthis.translateService.use(lang);\n\t\t\t// console.log('RouteService.set lang', lang, this.coreService.options.useLang);\n\t\t\tif (this.coreService.options.useLang) {\n\t\t\t\tconst _lang: string = this._lang;\n\t\t\t\tlet path = this.location.path();\n\t\t\t\tif (path.indexOf(`/${_lang}`) === 0) {\n\t\t\t\t\tpath = path.replace(`/${_lang}`, `/${lang}`);\n\t\t\t\t} else if (path.indexOf(`/${lang}`) !== 0) {\n\t\t\t\t\tpath = `/${lang}` + path;\n\t\t\t\t}\n\t\t\t\tthis.path = path;\n\t\t\t\t// const langIndex = this.urlStrategy.split('/').indexOf(':lang');\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic get currentLang(): string {\n\t\treturn this._lang;\n\t}\n\n\tpublic pageParams$: BehaviorSubject<Params> = new BehaviorSubject({});\n\tpublic getPageParams(): Observable<Params> {\n\t\t// console.log('RouteService.getPageParams', this.router.url);\n\t\treturn this.route.queryParams.pipe(\n\t\t\tdistinctUntilChanged(),\n\t\t\tswitchMap(params => {\n\t\t\t\t// console.log(params);\n\t\t\t\tconst parsed = this.parseParams(params);\n\t\t\t\tthis.pageParams$.next(parsed);\n\t\t\t\treturn of(parsed);\n\t\t\t}),\n\t\t\t// tap(params => console.log('RouteService.getPageParams', params)),\n\t\t);\n\t}\n\n\tpublic parseParams(params: any): any {\n\t\tconst parsed = {};\n\t\tObject.keys(params).forEach(k => parsed[k] = this.parse(params[k]));\n\t\t/*\n\t\tfor (const key in params) {\n\t\t\tif (typeof (params[key]) === 'string') {\n\t\t\t\tparsed[key] = this.parse(params[key]);\n\t\t\t} else {\n\t\t\t\tparsed[key] = params[key];\n\t\t\t}\n\t\t}\n\t\t*/\n\t\treturn parsed;\n\t}\n\n\tpublic serializeParams(params: any) {\n\t\tconst serialized = {};\n\t\tObject.keys(params).forEach(k => serialized[k] = this.serialize(params[k]));\n\t\treturn serialized;\n\t}\n\n\tpublic parse(base64) {\n\t\ttry {\n\t\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\t\treturn JSON.parse(window.atob(base64));\n\t\t\t} else {\n\t\t\t\treturn JSON.parse(Buffer.from(base64, 'base64').toString('ascii'));\n\t\t\t}\n\t\t} catch {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tpublic serialize(object) {\n\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\treturn window.btoa(JSON.stringify(object));\n\t\t} else {\n\t\t\treturn Buffer.from(JSON.stringify(object), 'ascii').toString('base64');\n\t\t}\n\t}\n\n\tpublic getId(): number {\n\t\treturn +this.route.snapshot.paramMap.get('id');\n\t}\n\n\tpublic getSlug(): string {\n\t\treturn this.route.snapshot.paramMap.get('slug');\n\t}\n\n\tpublic toRoute(data: any[] | string): any[] {\n\t\tconst segments = this.segment.transform(data);\n\t\tif (this.coreService.options.useMarket) {\n\t\t\tconst market: string = this.currentMarket;\n\t\t\tconst marketIndex = this.urlStrategy.split('/').indexOf(':market');\n\t\t\tsegments.splice(marketIndex, 0, market);\n\t\t}\n\t\tif (this.coreService.options.useLang) {\n\t\t\tconst lang: string = this._lang;\n\t\t\tconst langIndex = this.urlStrategy.split('/').indexOf(':lang');\n\t\t\tsegments.splice(langIndex, 0, lang);\n\t\t}\n\t\t// console.log('RouteService.toRoute', segments);\n\t\treturn segments;\n\t}\n\n\tpublic toSlug(data: any[] | string): any[] {\n\t\tconst segments = this.segment.transform(data);\n\t\tlet paths = segments.filter(x => {\n\t\t\treturn typeof x === 'string';\n\t\t});\n\t\tconst datas = segments.filter(x => {\n\t\t\treturn typeof x !== 'string';\n\t\t});\n\t\tif (this.coreService.options.useMarket) {\n\t\t\tconst marketIndex = this.urlStrategy.split('/').indexOf(':market');\n\t\t\tif (paths.length > marketIndex) {\n\t\t\t\tpaths[marketIndex] = '*';\n\t\t\t}\n\t\t}\n\t\tif (this.coreService.options.useLang) {\n\t\t\tconst langIndex = this.urlStrategy.split('/').indexOf(':lang');\n\t\t\tif (paths.length > langIndex) {\n\t\t\t\tpaths[langIndex] = '*';\n\t\t\t}\n\t\t}\n\t\tpaths = paths.join('/').replace(/\\/\\*/gi, '').split('/');\n\t\t// console.log('RouteService.toSlug', data, paths);\n\t\treturn paths.concat(datas);\n\t}\n\n\tpublic toParams(data: any): any {\n\t\treturn {\n\t\t\tdata: window.btoa(JSON.stringify(data))\n\t\t};\n\t}\n\n\tpublic toData(params: any): any {\n\t\tif (params && params.data) {\n\t\t\treturn JSON.parse(window.atob(params.data));\n\t\t}\n\t}\n\n\t/*\n\tpublic getParams(): Observable<ComponentFactory<PageComponent>> {\n\t\treturn this.router.events.pipe(\n\t\t\tfilter(event => event instanceof ActivationEnd),\n\t\t\tmap(() => this.route),\n\t\t\tdistinctUntilChanged(),\n\t\t\tmap(route => route.firstChild),\n\t\t\tswitchMap(route => route.params),\n\t\t\tconcatMap(x => {\n\t\t\t\treturn of(this.toData(x));\n\t\t\t})\n\t\t);\n\t}\n\t*/\n\n\tpublic setLanguage(lang: string, silent?: boolean) {\n\t\tthis.lang = lang;\n\t\tif (this.coreService.options.useLang && this.path) {\n\t\t\t// console.log('RouteService.setLanguage', this.path, this._lang, lang, silent);\n\t\t\tif (silent) {\n\t\t\t\tthis.location.replaceState(this.path);\n\t\t\t} else {\n\t\t\t\tthis.router.navigate([this.path]);\n\t\t\t}\n\t\t}\n\t}\n\n\t// PRIVATE METHODS\n\n\tprivate setLanguages() {\n\t\tthis.translateService.addLangs(this.coreService.options.languages ? this.coreService.options.languages.map(x => x.lang) : []);\n\t\tthis.translateService.setDefaultLang(this.coreService.options.defaultLanguage);\n\t\t// this.setLanguage(this.detectLanguage(), true);\n\t\tthis.setLanguage(this.coreService.options.defaultLanguage, true);\n\t\t/*\n\t\tthis.translateService.onLangChange.subscribe((e: LangChangeEvent) => {\n\t\t\t// console.log('RouteService.onLangChange', e);\n\t\t});\n\t\t*/\n\t}\n\n\tprivate subscribeToRouter() {\n\t\tthis.router.events.pipe(\n\t\t\tfilter(event => event instanceof NavigationStart)\n\t\t).subscribe((event: NavigationStart) => {\n\t\t\tconst location = this.location.normalize(event.url).split('/');\n\t\t\tif (this.coreService.options.useMarket) {\n\t\t\t\tconst marketIndex = this.urlStrategy.split('/').indexOf(':market');\n\t\t\t\tconst market = location[marketIndex];\n\t\t\t\tif (market !== this.currentMarket) {\n\t\t\t\t\tthis.currentMarket = market;\n\t\t\t\t\t// console.log('RouteService.setMarket', market, event.url);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.coreService.options.useLang) {\n\t\t\t\tconst langIndex = this.urlStrategy.split('/').indexOf(':lang');\n\t\t\t\tconst lang = location[langIndex];\n\t\t\t\tif (lang !== this._lang) {\n\t\t\t\t\tconst language = this._languages.getValue().find(x => x.lang === lang);\n\t\t\t\t\tthis._language.next(language);\n\t\t\t\t\tthis.translateService.use(lang);\n\t\t\t\t\t// console.log('RouteService.setLang', lang, this._lang, langIndex, location, event.url);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate detectLanguage(): string {\n\t\tlet acceptLanguage: string = null;\n\t\tif (isPlatformServer(this.platformId)) {\n\t\t\t/*\n\t\t\t// server side express engine\n\t\t\tapp.engine('html',  (_, options, callback) => {\n\t\t\t\tlet engine = ngExpressEngine({\n\t\t\t\t\tbootstrap: ServerAppModule,\n\t\t\t\t\tproviders: [ { provide: 'request', useFactory: () => options.req } ]\n\t\t\t\t});\n\t\t\t\tengine(_, options, callback)\n\t\t\t})\n\t\t\t*/\n\t\t\tconst request = this.injector.get('request');\n\t\t\tif (request) {\n\t\t\t\tacceptLanguage = request.headers['accept-language'];\n\t\t\t\tconst languages: string[] = acceptLanguage.match(/[a-zA-Z\\-]{2,10}/g) || [];\n\t\t\t\tif (languages.length > 0) {\n\t\t\t\t\tacceptLanguage = languages[0].split('-')[0];\n\t\t\t\t} else {\n\t\t\t\t\tacceptLanguage = null;\n\t\t\t\t}\n\t\t\t\t// console.log('request', request, 'acceptLanguage', acceptLanguage);\n\t\t\t}\n\t\t\t// console.log('RouteService.isPlatformServer', this.platformId, acceptLanguage);\n\t\t} else if (isPlatformBrowser(this.platformId)) {\n\t\t\tacceptLanguage = this.translateService.getBrowserLang();\n\t\t\t// console.log('RouteService.isPlatformBrowser', this.platformId, acceptLanguage);\n\t\t}\n\t\tlet detectedLanguage: string = this.coreService.options.defaultLanguage;\n\t\tconst regexp: RegExp = new RegExp(`(${this.coreService.options.languages ? this.coreService.options.languages.map(x => x.lang).join('|') : ''})`, 'gi');\n\t\tconst match = (acceptLanguage || '').match(regexp);\n\t\tdetectedLanguage = match ? match[0] : detectedLanguage;\n\t\t// console.log('RouteService.detectLanguage', detectedLanguage);\n\t\treturn detectedLanguage;\n\t}\n\n\tpublic getTime() {\n\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\treturn (performance || Date).now();\n\t\t} else {\n\t\t\tconst time = process.hrtime();\n\t\t\treturn (time[0] * 1e9 + time[1]) / 1e6;\n\t\t}\n\t}\n\n\tpublic start() {\n\t\tRouteService.startTime = this.getTime();\n\t}\n\n\tpublic end() {\n\t\tRouteService.endTime = this.getTime();\n\t\tconsole.log('RouteService.end', RouteService.endTime - RouteService.startTime);\n\t}\n\n}\n","import { Injectable } from '@angular/core';\n\n@Injectable()\nexport class HttpStatusCodeService {\n\n\tprivate statusCode: number;\n\tprivate redirectUrl: string;\n\n\tconstructor() {\n\t\tthis.statusCode = 200;\n\t\tthis.redirectUrl = null;\n\t}\n\n\tpublic setStatusCode(statusCode: number, redirectUrl: string = null) {\n\t\tthis.statusCode = statusCode;\n\t\tthis.redirectUrl = redirectUrl;\n\t}\n\n\tpublic getStatusCode(): number {\n\t\treturn (this.statusCode === 309 ? 301 : this.statusCode);\n\t}\n\n\tpublic getRedirectUrl(): string {\n\t\treturn this.redirectUrl;\n\t}\n\n}\n","\nimport { HttpErrorResponse, HttpEvent, HttpHandler, HttpInterceptor, HttpRequest } from '@angular/common/http';\nimport { Injectable, Injector } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, tap } from 'rxjs/operators';\nimport { Logger } from '../logger/logger';\nimport { RouteService } from '../route/route.service';\nimport { HttpStatusCodeService } from './http-status-code.service';\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class HttpResponseInterceptor implements HttpInterceptor {\n\n\tprivate _logger: Logger;\n\tget logger() {\n\t\tif (!this._logger) {\n\t\t\tthis._logger = this.injector.get(Logger);\n\t\t}\n\t\treturn this._logger;\n\t}\n\n\tprivate _router: Router;\n\tget router() {\n\t\tif (!this._router) {\n\t\t\tthis._router = this.injector.get(Router);\n\t\t}\n\t\treturn this._router;\n\t}\n\n\tprivate _routeService: RouteService;\n\tget routeService() {\n\t\tif (!this._routeService) {\n\t\t\tthis._routeService = this.injector.get(RouteService);\n\t\t}\n\t\treturn this.routeService;\n\t}\n\n\tconstructor(\n\t\tprivate injector: Injector,\n\t\tprivate statusCodeService: HttpStatusCodeService,\n\t) { }\n\n\tintercept(request: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n\t\t// injecting request\n\t\t// parsing response\n\t\treturn next.handle(request).pipe(\n\t\t\ttap((event: HttpEvent<any>) => {\n\t\t\t\t// console.log('HttpResponseInterceptor', event);\n\t\t\t\tthis.logger.httpError = null;\n\t\t\t\t// this.logger.log(event);\n\t\t\t\t/*\n\t\t\t\tif (event instanceof HttpResponse) {\n\t\t\t\t\t// console.log('event instanceof HttpResponse');\n\t\t\t\t\t// do stuff with response if you want\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t}),\n\t\t\tcatchError((error: any) => {\n\t\t\t\t// console.warn('HttpResponseInterceptor', error);\n\t\t\t\tif (error instanceof HttpErrorResponse) {\n\t\t\t\t\t// this.statusCodeService.setStatusCode(error.status);\n\t\t\t\t\tswitch (error.status) {\n\t\t\t\t\t\tcase 401:\n\t\t\t\t\t\t\t// unauthorized\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 404:\n\t\t\t\t\t\t\t// not found\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 409:\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 410:\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tthis.logger.http(error);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn throwError(error);\n\t\t\t})\n\t\t);\n\t}\n\n}\n","import { isPlatformBrowser } from '@angular/common';\nimport { Component, ElementRef, Inject, Input, OnChanges, PLATFORM_ID, ViewChild, ViewEncapsulation } from '@angular/core';\n// require('json-formatter-js').default\nimport JSONFormatter from 'json-formatter-js';\nimport { isArray, isObject } from 'util';\n\n@Component({\n\tselector: 'json-formatter',\n\ttemplate: `<div #jsonFormatter></div>`,\n\tstyleUrls: ['./json-formatter.component.scss'],\n\tencapsulation: ViewEncapsulation.Emulated,\n})\nexport class JsonFormatterComponent implements OnChanges {\n\t@ViewChild(`jsonFormatter`) input: ElementRef;\n\n\t@Input() json: Array<any> | Object | any;\n\n\telementRef: ElementRef;\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t) { }\n\n\tngOnChanges() {\n\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\tif (!isObject(this.json) && !isArray(this.json)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// console.log('JsonFormatterComponent', this.json);\n\t\t\tif (this.elementRef) {\n\t\t\t\tthis.input.nativeElement.removeChild(this.elementRef.nativeElement);\n\t\t\t}\n\t\t\t// const JSONFormatter = require('json-formatter-js').default;\n\t\t\tconst formatter = new JSONFormatter(this.json);\n\t\t\tconst elementRef = formatter.render();\n\t\t\tthis.input.nativeElement.appendChild(elementRef);\n\t\t\tthis.elementRef = new ElementRef(elementRef);\n\t\t}\n\t}\n}\n","import { EventEmitter, Injectable, Injector } from '@angular/core';\nimport { BehaviorSubject, Observable, of } from 'rxjs';\nimport { catchError, debounceTime, filter, map, switchMap, tap } from 'rxjs/operators';\nimport { ApiService } from '../api/api.service';\nimport { Label } from './label';\n\nexport class LabelKey {\n\tid?: string;\n\tvalue?: string;\n\tdefaultValue?: string;\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class LabelService<T extends Label> extends ApiService<T> {\n\n\tget collection(): string {\n\t\treturn '/api/label';\n\t}\n\n\tprivate keys: { [key: string]: LabelKey; } = {};\n\tprivate values$: BehaviorSubject<{ [key: string]: string; }> = new BehaviorSubject({});\n\tprivate emitter$: EventEmitter<any> = new EventEmitter();\n\n\tpublic missingHandler?: Function;\n\n\tconstructor(\n\t\tprotected injector: Injector,\n\t) {\n\t\tsuper(injector);\n\t}\n\n\ttransform(key: string, defaultValue?: string, params?: any): string | undefined {\n\t\tconst values = this.values$.getValue();\n\t\tif (values.hasOwnProperty(key)) {\n\t\t\treturn this.parseLabel(values[key], params);\n\t\t} else if (!this.keys.hasOwnProperty(key)) {\n\t\t\tvalues[key] = null;\n\t\t\tObject.defineProperty(this.keys, key, {\n\t\t\t\tvalue: { id: key, defaultValue: defaultValue },\n\t\t\t\tenumerable: true,\n\t\t\t\twritable: false,\n\t\t\t});\n\t\t\tthis.emitter$.emit();\n\t\t\treturn null;\n\t\t}\n\t}\n\n\ttransform$(key: string, defaultValue?: string, params?: any): Observable<string | undefined> {\n\t\tconst values = this.values$.getValue();\n\t\tif (values.hasOwnProperty(key)) {\n\t\t\treturn of(this.parseLabel(values[key], params));\n\t\t} else if (!this.keys.hasOwnProperty(key)) {\n\t\t\tvalues[key] = null;\n\t\t\tObject.defineProperty(this.keys, key, {\n\t\t\t\tvalue: { id: key, defaultValue: defaultValue },\n\t\t\t\tenumerable: true,\n\t\t\t\twritable: false,\n\t\t\t});\n\t\t\tthis.emitter$.emit();\n\t\t}\n\t\treturn this.values$.pipe(\n\t\t\tmap(values => this.parseLabel(values[key], params))\n\t\t);\n\t}\n\n\tobserve$(): Observable<{ [key: string]: string; }> {\n\t\treturn this.emitter$.pipe(\n\t\t\tdebounceTime(1),\n\t\t\tswitchMap(x => this.collect$()),\n\t\t\tfilter(x => x !== null),\n\t\t);\n\t}\n\n\tcollect$(): Observable<{ [key: string]: string; }> {\n\t\tif (Object.keys(this.keys).length) {\n\t\t\tconst keys = Object.keys(this.keys).map(x => this.keys[x]);\n\t\t\tthis.keys = {};\n\t\t\treturn this.statePost(keys).pipe(\n\t\t\t\tmap((labels: LabelKey[]) => {\n\t\t\t\t\treturn labels.reduce((values, x) => {\n\t\t\t\t\t\tvalues[x.id] = this.getLabel(x);\n\t\t\t\t\t\treturn values;\n\t\t\t\t\t}, {});\n\t\t\t\t}),\n\t\t\t\ttap((labels: { [key: string]: string; }) => {\n\t\t\t\t\tconst values = this.values$.getValue();\n\t\t\t\t\tObject.assign(values, labels);\n\t\t\t\t\tthis.values$.next(values);\n\t\t\t\t}),\n\t\t\t\tcatchError(error => {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t\tconst labels = keys.reduce((values, x) => {\n\t\t\t\t\t\tvalues[x.id] = this.getLabel(x);\n\t\t\t\t\t\treturn values;\n\t\t\t\t\t}, {});\n\t\t\t\t\tconst values = this.values$.getValue();\n\t\t\t\t\tObject.assign(values, labels);\n\t\t\t\t\t// return this.values$.next(values);\n\t\t\t\t\treturn of(null);\n\t\t\t\t}),\n\t\t\t);\n\t\t} else {\n\t\t\treturn of(null);\n\t\t}\n\t}\n\n\tpublic parseLabel(value: string, params: any): string {\n\t\tif (value && params) {\n\t\t\tconst TEMPLATE_REGEXP: RegExp = /@([^{}\\s]*)/g;\n\t\t\treturn value.replace(TEMPLATE_REGEXP, (text: string, key: string) => {\n\t\t\t\tconst replacer: string = params[key] as string;\n\t\t\t\treturn typeof replacer !== 'undefined' ? replacer : text;\n\t\t\t});\n\t\t} else {\n\t\t\treturn value;\n\t\t}\n\t}\n\n\tprivate getLabel(label: LabelKey): string | undefined {\n\t\treturn label.value || label.defaultValue || this.getMissingLabel(label);\n\t}\n\n\tprivate getMissingLabel(label: LabelKey): string | undefined {\n\t\tif (typeof this.missingHandler === 'function') {\n\t\t\treturn this.missingHandler(label);\n\t\t}\n\t\treturn label.id;\n\t}\n\n}\n","import { Directive, ElementRef, Input, OnInit } from '@angular/core';\nimport { takeUntil } from 'rxjs/operators';\nimport { DisposableComponent } from '../disposable/disposable.component';\nimport { Label } from './label';\nimport { LabelService } from './label.service';\n\n@Directive({\n\tselector: '[label]'\n})\nexport class LabelDirective extends DisposableComponent implements OnInit {\n\n\t// key: string;\n\t// innerHTML: string;\n\t@Input() label: string;\n\t@Input() labelParams: any;\n\n\tconstructor(\n\t\tprivate element: ElementRef,\n\t\tprivate labelService: LabelService<Label>,\n\t) {\n\t\tsuper();\n\t}\n\n\tngOnInit() {\n\t\tthis.labelService.transform$(this.label, this.element.nativeElement.innerHTML, this.labelParams).pipe(\n\t\t\ttakeUntil(this.unsubscribe)\n\t\t).subscribe(label => {\n\t\t\tthis.element.nativeElement.innerHTML = label;\n\t\t});\n\t}\n\n}\n","import { Injectable, Pipe, PipeTransform } from '@angular/core';\nimport { Label } from './label';\nimport { LabelService } from './label.service';\n\n@Pipe({\n\tname: 'label',\n\tpure: false\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class LabelPipe implements PipeTransform {\n\n\tconstructor(\n\t\tprivate labelService: LabelService<Label>,\n\t) { }\n\n\ttransform(key: string, defaultValue?: string, params?: any): string | undefined {\n\t\treturn this.labelService.transform(key, defaultValue, params);\n\t}\n\n}\n","import { Component, OnInit, ViewEncapsulation } from '@angular/core';\nimport { Logger } from './logger';\n\n@Component({\n\tselector: 'core-logger',\n\ttemplateUrl: './logger.component.html',\n\tstyleUrls: ['./logger.component.scss'],\n\tencapsulation: ViewEncapsulation.Emulated,\n})\nexport class LoggerComponent implements OnInit {\n\tconstructor(public logger: Logger) { }\n\n\tngOnInit() {\n\t}\n}\n","import { EventEmitter, Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { tap } from 'rxjs/operators';\n\nexport class EventEntity {\n\ttype: string | number;\n\tdata?: any;\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class EventDispatcherService {\n\n\tprivate emitter: EventEmitter<EventEntity>;\n\n\tconstructor() {\n\t\tthis.emitter = new EventEmitter<EventEntity>();\n\t}\n\n\temit(event: EventEntity): void {\n\t\treturn this.emitter.emit(event);\n\t}\n\n\tobserve(): Observable<EventEntity> {\n\t\treturn this.emitter.pipe(\n\t\t\ttap((event: EventEntity) => console.log('EventDispatcherService', event))\n\t\t);\n\t}\n\n}\n","import { Injectable, Injector } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { ApiService } from '../api/api.service';\nimport { Identity } from './identity';\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class IdentityService<T extends Identity> extends ApiService<T> {\n\n\tconstructor(\n\t\tprotected injector: Injector\n\t) {\n\t\tsuper(injector);\n\t}\n\n\tget collection(): string {\n\t\treturn '/api/identity';\n\t}\n\n\tgetDetailById(id: number | string): Observable<T> {\n\t\treturn this.get({ id });\n\t}\n\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport { Entity } from './entity';\nimport { IdentityService } from './identity.service';\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class EntityService<T extends Entity> extends IdentityService<T> {\n\n\tget collection(): string {\n\t\treturn '/api/entity';\n\t}\n\n\tgetDetailByName(name: string): Observable<any> {\n\t\tif (!name.trim()) {\n\t\t\treturn of([]);\n\t\t}\n\t\treturn this.get({ name });\n\t}\n\n}\n","import { Injectable, Injector } from '@angular/core';\nimport { EntityService } from './entity.service';\nimport { MenuItem } from './menu-item';\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class MenuService extends EntityService<MenuItem> {\n\n\tget collection(): string {\n\t\treturn '/api/menu';\n\t}\n\n\tconstructor(\n\t\tprotected injector: Injector,\n\t) {\n\t\tsuper(injector);\n\t}\n\n}\n","import { isPlatformBrowser } from '@angular/common';\nimport { Inject, Injectable, NgZone, PLATFORM_ID } from '@angular/core';\nimport { from, fromEvent, Observable, of } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\n// export class OnceEvent extends Event { }\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class OnceService {\n\n\tprivate uid: number = 0;\n\tprivate paths: string[] = [];\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t\tprivate zone: NgZone,\n\t) { }\n\n\tscript(url: string, callback?: string | boolean): Observable<Event> {\n\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\t// !!! this.zone.runOutsideAngular(() => {\n\t\t\tif (this.paths.indexOf(url) === -1) {\n\t\t\t\tthis.paths.push(url);\n\t\t\t\tlet callbackName: string;\n\t\t\t\tif (callback === true) {\n\t\t\t\t\tcallbackName = 'OnceCallback' + (++this.uid);\n\t\t\t\t\turl = url.split('{{callback}}').join(callbackName);\n\t\t\t\t} else {\n\t\t\t\t\tcallbackName = callback as string;\n\t\t\t\t}\n\t\t\t\tlet callback$: Observable<any>;\n\t\t\t\tconst element = document.createElement('script');\n\t\t\t\telement.type = 'text/javascript';\n\t\t\t\tif (callback) {\n\t\t\t\t\tcallback$ = from(\n\t\t\t\t\t\tnew Promise((resolve, reject) => {\n\t\t\t\t\t\t\twindow[callbackName] = function (data) {\n\t\t\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\telement.async = true;\n\t\t\t\t\tcallback$ = fromEvent(element, 'load').pipe(\n\t\t\t\t\t\tmap(x => x as Event)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tconst scripts = document.getElementsByTagName('script');\n\t\t\t\tif (scripts.length) {\n\t\t\t\t\tconst script = scripts[scripts.length - 1];\n\t\t\t\t\tscript.parentNode.insertBefore(element, script.nextSibling);\n\t\t\t\t}\n\t\t\t\telement.src = url;\n\t\t\t\treturn callback$;\n\t\t\t} else {\n\t\t\t\treturn of(new Event('loaded!'));\n\t\t\t}\n\t\t\t// });\n\t\t} else {\n\t\t\treturn of(null);\n\t\t}\n\t}\n}\n","\nimport { Component, Input } from '@angular/core';\nimport { DisposableComponent } from '../disposable/disposable.component';\nimport { Outlet } from './outlet';\n\n@Component({\n\tselector: 'outlet-content-component',\n\ttemplate: `<div class=\"outlet\">Outlet not found!</div>`,\n})\nexport class OutletDefaultComponent extends DisposableComponent {\n\t@Input() outlet: Outlet;\n}\n","\nimport { Component, Input } from '@angular/core';\nimport { DisposableComponent } from '../disposable/disposable.component';\nimport { Outlet } from './outlet';\n\n@Component({\n\tselector: 'outlet-repeater-component',\n\ttemplate: `<ng-container *ngFor=\"let outlet of outlets\"><outlet-component [outlet]=\"outlet\"></outlet-component></ng-container>`,\n})\nexport class OutletRepeaterComponent extends DisposableComponent {\n\t@Input() outlets: Outlet[];\n}\n","import { InjectionToken, Type } from '@angular/core';\nimport { OutletDefaultComponent } from './outlet-default.component';\n\nexport interface OutletInit {\n\tOutletInit(): void;\n}\n\nexport interface Outlets { [key: string]: Type<OutletDefaultComponent>; }\n\nexport const OUTLETS = new InjectionToken<Outlets>('core.outlets');\n\nexport class Outlet {\n\t// id: number | string;\n\tname?: string;\n\tcomponent?: number | string;\n}\n","import { Inject, Injectable, Type } from '@angular/core';\nimport { Outlet, OUTLETS, Outlets } from './outlet';\nimport { OutletDefaultComponent } from './outlet-default.component';\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class OutletResolverService {\n\n\tpublic outlets: Outlets;\n\n\tconstructor(\n\t\t@Inject(OUTLETS) outlets: Outlets,\n\t) {\n\t\toutlets = outlets || {};\n\t}\n\n\tresolve(outlet: Outlet): Type<OutletDefaultComponent> {\n\t\tlet component: Type<OutletDefaultComponent>;\n\t\tif (outlet) {\n\t\t\tcomponent = this.outlets[outlet.component] || OutletDefaultComponent;\n\t\t} else {\n\t\t\tcomponent = OutletDefaultComponent;\n\t\t}\n\t\treturn component;\n\t}\n\n}\n","import { Component, ComponentFactory, ComponentFactoryResolver, ComponentRef, Input, OnDestroy, OnInit, Type, ViewChild, ViewContainerRef } from '@angular/core';\nimport { DisposableComponent } from '../disposable/disposable.component';\nimport { Outlet } from './outlet';\nimport { OutletDefaultComponent } from './outlet-default.component';\nimport { OutletResolverService } from './outlet-resolver.service';\n\n@Component({\n\tselector: 'outlet-component',\n\ttemplate: '',\n})\nexport class OutletComponent extends DisposableComponent implements OnInit, OnDestroy {\n\n\t@Input() outlet: Outlet;\n\n\t@ViewChild('outlet', { read: ViewContainerRef }) viewContainerRef: ViewContainerRef;\n\tprivate componentRef: ComponentRef<DisposableComponent>;\n\n\tconstructor(\n\t\tprivate componentFactoryResolver: ComponentFactoryResolver,\n\t\tprivate outletResolverService: OutletResolverService,\n\t) {\n\t\tsuper();\n\t}\n\n\tngOnInit() {\n\t\tconst component: Type<OutletDefaultComponent> = this.outletResolverService.resolve(this.outlet);\n\t\tconst factory: ComponentFactory<OutletDefaultComponent> = this.componentFactoryResolver.resolveComponentFactory(component);\n\t\tthis.viewContainerRef.clear();\n\t\tconst componentRef = this.viewContainerRef.createComponent(factory);\n\t\tconst instance = componentRef.instance;\n\t\tinstance.outlet = this.outlet;\n\t\tif (typeof instance['OutletInit'] === 'function') {\n\t\t\tinstance['OutletInit']();\n\t\t}\n\t\tthis.componentRef = componentRef;\n\t}\n\n\tngOnDestroy() {\n\t\tthis.componentRef.destroy();\n\t}\n\n}\n","import { Injectable, Pipe, PipeTransform } from '@angular/core';\nimport { CoreService } from '../config/core.service';\nimport { SegmentPipe } from './segment.pipe';\n\n@Pipe({\n\tname: 'asset',\n\t// pure: false\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class AssetPipe implements PipeTransform {\n\n\tconstructor(\n\t\tprivate coreService: CoreService,\n\t\tprivate segment: SegmentPipe\n\t) { }\n\n\ttransform(data: any[] | string): string {\n\t\tif (typeof data === 'string' && (data.indexOf('http') === 0 || data.indexOf('/media/') === 0)) {\n\t\t\treturn data;\n\t\t} else {\n\t\t\tconst segments = this.segment.transform(data);\n\t\t\tsegments.unshift(this.coreService.options.assets);\n\t\t\treturn segments.join('/');\n\t\t}\n\t}\n\n}\n","import { ChangeDetectorRef, OnDestroy, Pipe, PipeTransform, WrappedValue } from '@angular/core';\nimport { Observable, SubscriptionLike } from 'rxjs';\n\n@Pipe({\n\tname: 'customAsync',\n\tpure: false\n})\nexport class CustomAsyncPipe implements OnDestroy, PipeTransform {\n\n\tprivate subject: Observable<any> | null = null;\n\tprivate subscription: SubscriptionLike | null = null;\n\tprivate value: any = null;\n\tprivate cachedValue: any = null;\n\n\tconstructor(\n\t\tprivate changeDetector: ChangeDetectorRef\n\t) { }\n\n\ttransform(subject: Observable<any> | null | undefined): any {\n\t\treturn this.observableToValue(subject);\n\t}\n\n\tprivate observableToValue(subject: Observable<any> | null | undefined): any {\n\t\tif (subject !== this.subject) {\n\t\t\tif (this.subject) {\n\t\t\t\tthis.dispose();\n\t\t\t}\n\t\t\tif (subject) {\n\t\t\t\tthis.subject = subject;\n\t\t\t\tthis.subscription = this.subject.subscribe((value: any) => {\n\t\t\t\t\t// console.log('CustomAsyncPipe.A', value);\n\t\t\t\t\tthis.value = value;\n\t\t\t\t\tthis.changeDetector.markForCheck(); // mark pipe as dirty\n\t\t\t\t});\n\t\t\t\tthis.cachedValue = this.value; // ???\n\t\t\t\treturn this.value;\n\t\t\t}\n\t\t}\n\t\t// console.log('CustomAsyncPipe.B', this.value);\n\t\tif (this.cachedValue !== this.value) {\n\t\t\tthis.cachedValue = this.value;\n\t\t\treturn WrappedValue.wrap(this.value); // notify that value has changed\n\t\t}\n\t\treturn this.cachedValue; // return cachedValue\n\t}\n\n\tpublic dispose(): void {\n\t\tif (this.subscription) {\n\t\t\tthis.subscription.unsubscribe();\n\t\t}\n\t\tthis.value = null;\n\t\tthis.cachedValue = null;\n\t\tthis.subscription = null;\n\t\tthis.subject = null;\n\t}\n\n\tngOnDestroy(): void {\n\t\tthis.dispose();\n\t}\n\n\tprivate _observableToValue(subject: Observable<any> | null | undefined): any {\n\t\tif (!this.subject) {\n\t\t\tif (subject) {\n\t\t\t\tthis.subject = subject;\n\t\t\t\tthis.subscription = this.subject.subscribe((value: any) => {\n\t\t\t\t\tthis.value = value;\n\t\t\t\t\tthis.changeDetector.markForCheck(); // value has changed\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.cachedValue = this.value;\n\t\t\treturn this.value;\n\t\t}\n\t\tif (subject !== this.subject) {\n\t\t\tthis.dispose();\n\t\t\treturn this.transform(subject as any);\n\t\t}\n\t\tif (this.value === this.cachedValue) {\n\t\t\treturn this.cachedValue;\n\t\t}\n\t\tthis.cachedValue = this.value;\n\t\treturn WrappedValue.wrap(this.value); // value has changed\n\t}\n\n}\n","\nexport enum ImageType {\n\tDefault = 1,\n\tGallery = 2,\n\tShare = 3,\n}\n\nexport class Image {\n\tid: number | string;\n\turl: string;\n\ttitle?: string;\n\tdescription?: string;\n\tfileName?: string;\n\ttype?: ImageType;\n}\n","import { Injectable, Pipe, PipeTransform } from '@angular/core';\nimport { Image, ImageType } from '../models/image';\n\n@Pipe({\n\tname: 'imageUrl',\n\t// pure: false\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class ImageUrlPipe implements PipeTransform {\n\n\ttransform(images: Image[], type?: string, queryString?: string): string {\n\t\ttype = type || 'Default';\n\t\tqueryString = queryString ? `?${queryString}` : '';\n\t\tconst imageType: ImageType = ImageType[type] || ImageType.Default;\n\t\tlet image: Image = null;\n\t\tif (images && images.length) {\n\t\t\timage = images.find(i => i.type === imageType) || images[0];\n\t\t}\n\t\treturn image ? (image.url + queryString).replace(/ /g, '%20') : null;\n\t}\n\n}\n","import { Injectable, Pipe, PipeTransform } from '@angular/core';\nimport { Image, ImageType } from '../models/image';\n\n@Pipe({\n\tname: 'image',\n\t// pure: false\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class ImagePipe implements PipeTransform {\n\n\ttransform(images: Image[], type?: string, queryString?: string): Image {\n\t\ttype = type || 'Default';\n\t\tconst imageType: ImageType = ImageType[type] || ImageType.Default;\n\t\treturn (images && images.length) ? images.find(i => i.type === imageType) || null : null; // images[0]\n\t}\n\n\t// 21 marzo 2019\n\ttransform__(images: Image[], type?: string, queryString?: string): string {\n\t\ttype = type || 'Default';\n\t\tqueryString = queryString ? `?${queryString}` : '';\n\t\tconst imageType: ImageType = ImageType[type] || ImageType.Default;\n\t\tlet image: Image = null;\n\t\tif (images && images.length) {\n\t\t\timage = images.find(i => i.type === imageType); // || images[0];\n\t\t\tif (!image && imageType !== ImageType.Default) {\n\t\t\t\timage = images.find(i => i.type === ImageType.Default);\n\t\t\t}\n\t\t}\n\t\treturn image ? (image.url + queryString).replace(/ /g, '%20') : null;\n\t}\n\n}\n","import { Injectable, Pipe, PipeTransform } from '@angular/core';\nimport { CoreService } from '../config/core.service';\nimport { SegmentPipe } from './segment.pipe';\n\n@Pipe({\n\tname: 'public',\n\t// pure: false\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class PublicPipe implements PipeTransform {\n\n\tconstructor(\n\t\tprivate coreService: CoreService,\n\t\tprivate segment: SegmentPipe\n\t) { }\n\n\ttransform(data: any[] | string): string {\n\t\tconst segments = this.segment.transform(data);\n\t\tsegments.unshift(this.coreService.options.public);\n\t\treturn segments.join('/');\n\t}\n\n}\n","import { Injectable, Pipe, PipeTransform } from '@angular/core';\nimport { RouteService } from './route.service';\n\n@Pipe({\n\tname: 'route',\n\tpure: false\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class RoutePipe implements PipeTransform {\n\n\tconstructor(\n\t\tprivate routeService: RouteService,\n\t) { }\n\n\ttransform(data: any[] | string): string[] {\n\t\treturn this.routeService.toRoute(data);\n\t}\n\n}\n","import { EventEmitter, Injectable, Injector } from '@angular/core';\nimport { BehaviorSubject, Observable, of } from 'rxjs';\nimport { catchError, debounceTime, filter, first, map, switchMap, tap } from 'rxjs/operators';\nimport { DocumentIndex } from '../models/document';\nimport { EntityService } from '../models/entity.service';\n\nexport class SlugKey {\n\tid?: number;\n\tmnemonic?: string;\n\tslug?: string;\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class SlugService extends EntityService<DocumentIndex> {\n\n\tget collection(): string {\n\t\treturn `/api/slug`;\n\t}\n\n\tprivate keys: { [key: string]: SlugKey; } = {};\n\tprivate values$: BehaviorSubject<{ [key: string]: string; }> = new BehaviorSubject({});\n\tprivate emitter$: EventEmitter<any> = new EventEmitter();\n\n\tpublic missingHandler?: Function;\n\n\tconstructor(\n\t\tprotected injector: Injector,\n\t) {\n\t\tsuper(injector);\n\t}\n\n\ttransform(key: string): string | undefined {\n\t\tconst values = this.values$.getValue();\n\t\tif (values.hasOwnProperty(key)) {\n\t\t\treturn values[key];\n\t\t} else if (!this.keys.hasOwnProperty(key)) {\n\t\t\tvalues[key] = null;\n\t\t\tObject.defineProperty(this.keys, key, {\n\t\t\t\tvalue: { mnemonic: key },\n\t\t\t\tenumerable: true,\n\t\t\t\twritable: false,\n\t\t\t});\n\t\t\tthis.emitter$.emit();\n\t\t\treturn null;\n\t\t}\n\t}\n\n\ttransform$(key: string): Observable<string | undefined> {\n\t\tconst values = this.values$.getValue();\n\t\tif (values.hasOwnProperty(key)) {\n\t\t\treturn of(values[key]);\n\t\t} else if (!this.keys.hasOwnProperty(key)) {\n\t\t\tObject.defineProperty(this.keys, key, {\n\t\t\t\tvalue: { mnemonic: key },\n\t\t\t\tenumerable: true,\n\t\t\t\twritable: false,\n\t\t\t});\n\t\t\tthis.emitter$.emit();\n\t\t}\n\t\treturn this.values$.pipe(\n\t\t\tmap(values => values[key])\n\t\t);\n\t}\n\n\tobserve$(): Observable<{ [key: string]: string; }> {\n\t\treturn this.emitter$.pipe(\n\t\t\tdebounceTime(1),\n\t\t\tswitchMap(x => this.collect$()),\n\t\t\tfilter(x => x !== null),\n\t\t\tfirst(), //\n\t\t);\n\t}\n\n\tcollect$(): Observable<{ [key: string]: string; }> {\n\t\tif (Object.keys(this.keys).length) {\n\t\t\tconst keys = Object.keys(this.keys).map(x => this.keys[x]);\n\t\t\tthis.keys = {};\n\t\t\treturn this.statePost(keys).pipe(\n\t\t\t\tmap((items: DocumentIndex[]) => {\n\t\t\t\t\treturn items.reduce((values, x) => {\n\t\t\t\t\t\tvalues[x.mnemonic] = [x.slug];\n\t\t\t\t\t\treturn values;\n\t\t\t\t\t}, {});\n\t\t\t\t}),\n\t\t\t\ttap((slugs: { [key: string]: string; }) => {\n\t\t\t\t\tconst values = this.values$.getValue();\n\t\t\t\t\tObject.assign(values, slugs);\n\t\t\t\t\tthis.values$.next(values);\n\t\t\t\t}),\n\t\t\t\tcatchError(error => {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t\tconst labels = keys.reduce((values, x) => {\n\t\t\t\t\t\tvalues[x.mnemonic] = null;\n\t\t\t\t\t\treturn values;\n\t\t\t\t\t}, {});\n\t\t\t\t\tconst values = this.values$.getValue();\n\t\t\t\t\tObject.assign(values, labels);\n\t\t\t\t\treturn of(null);\n\t\t\t\t}),\n\t\t\t);\n\t\t} else {\n\t\t\treturn of(null);\n\t\t}\n\t}\n\n}\n","import { Injectable, Pipe, PipeTransform } from '@angular/core';\nimport { RoutePipe } from '../route/route.pipe';\nimport { SlugService } from './slug.service';\n\n@Pipe({\n\tname: 'slug',\n\tpure: false\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class SlugPipe implements PipeTransform {\n\n\tconstructor(\n\t\tprivate slugService: SlugService,\n\t\tprivate routePipe: RoutePipe,\n\t) { }\n\n\ttransform(key: string, segments?: string[]): string[] {\n\t\tconst slug = this.slugService.transform(key);\n\t\tif (slug) {\n\t\t\tlet slugs = this.routePipe.transform(slug);\n\t\t\tif (slugs && segments) {\n\t\t\t\tslugs = slugs.concat(segments);\n\t\t\t}\n\t\t\treturn slugs;\n\t\t} else {\n\t\t\treturn [];\n\t\t}\n\t}\n\n}\n","import { Directive, ElementRef, Input, OnInit } from '@angular/core';\nimport { takeUntil } from 'rxjs/operators';\nimport { DisposableComponent } from '../disposable/disposable.component';\nimport { Translate } from './translate';\nimport { TranslateService } from './translate.service';\n\n@Directive({\n\tselector: '[translate]'\n})\nexport class TranslateDirective extends DisposableComponent implements OnInit {\n\n\tkey: string;\n\tinnerHTML: string;\n\n\t/*\n\t@Input() set translate(key: string) {\n\t\t// console.log('TranslateDirective.translate', this.key, this.translateParams, this.template, this.view);\n\t}\n\t*/\n\t@Input() translate: string;\n\t@Input() translateParams: any;\n\n\tconstructor(\n\t\tprivate element: ElementRef,\n\t\tprivate translateService: TranslateService<Translate>,\n\t) {\n\t\tsuper();\n\t}\n\n\tngOnInit() {\n\t\t// console.log('TranslateDirective.ngOnInit', this.element.nativeElement.innerHTML);\n\t\tthis.translateService.getTranslate(this.translate, this.element.nativeElement.innerHTML, this.translateParams).pipe(\n\t\t\ttakeUntil(this.unsubscribe)\n\t\t).subscribe(translate => {\n\t\t\tthis.element.nativeElement.innerHTML = translate;\n\t\t\t// console.log('TranslateDirective.ngOnInit', translate);\n\t\t});\n\t\t// console.log('TranslateDirective.ngOnInit', this.translate, this.translateParams, this.template, this.view);\n\t}\n}\n","import { ChangeDetectorRef, Injectable, Pipe, PipeTransform } from '@angular/core';\nimport { Translate } from './translate';\nimport { TranslateService } from './translate.service';\n\n@Pipe({\n\tname: 'translate',\n\tpure: false,\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class TranslatePipe implements PipeTransform {\n\n\tconstructor(\n\t\tprivate ref: ChangeDetectorRef,\n\t\tprotected translateService: TranslateService<Translate>\n\t) {\n\t\tthis.translateService.events.subscribe(\n\t\t\tx => this.ref.markForCheck()\n\t\t);\n\t}\n\n\tpublic transform(key: string, text?: string, params?: any): string {\n\t\t// console.log(key, params);\n\t\tconst label = this.translateService.getTranslate(key, text, params);\n\t\t// console.log('label', label, this.translateService.cache);\n\t\treturn label;\n\t}\n\n}\n","import { Injectable, Pipe, PipeTransform } from '@angular/core';\nimport { DomSanitizer } from '@angular/platform-browser';\n\n@Pipe({\n\tname: 'safeStyle'\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class SafeStylePipe implements PipeTransform {\n\n\tconstructor(\n\t\tprivate sanitizer: DomSanitizer\n\t) { }\n\n\ttransform(style: string) {\n\t\treturn this.sanitizer.bypassSecurityTrustStyle(style);\n\t}\n}\n","import { Injectable, Pipe, PipeTransform } from '@angular/core';\nimport { DomSanitizer } from '@angular/platform-browser';\n\n@Pipe({\n\tname: 'safeUrl'\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class SafeUrlPipe implements PipeTransform {\n\n\tconstructor(\n\t\tprivate sanitizer: DomSanitizer\n\t) { }\n\n\ttransform(url: string) {\n\t\treturn this.sanitizer.bypassSecurityTrustResourceUrl(url);\n\t}\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { DomSanitizer } from '@angular/platform-browser';\n\n@Pipe({\n\tname: 'safeHtml'\n})\nexport class TrustPipe implements PipeTransform {\n\n\tconstructor(\n\t\tprivate sanitizer: DomSanitizer\n\t) { }\n\n\ttransform(text: string) {\n\t\treturn this.sanitizer.bypassSecurityTrustHtml(text);\n\t\t// return this.sanitizer.bypassSecurityTrustStyle(text);\n\t\t// return this.sanitizer.bypassSecurityTrustXxx(text); - see docs\n\t}\n}\n","import { CommonModule } from '@angular/common';\r\nimport { HttpClientModule, HTTP_INTERCEPTORS } from '@angular/common/http';\r\nimport { ModuleWithProviders, NgModule, NgModuleFactoryLoader, Optional, SkipSelf, SystemJsNgModuleLoader } from '@angular/core';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { AuthService } from './auth/auth.service';\r\nimport { Bundles, BUNDLES } from './bundle/bundle';\r\nimport { BundleDirective } from './bundle/bundle.directive';\r\nimport { CoreConfig, CORE_CONFIG } from './config/core.config';\r\nimport { CoreService } from './config/core.service';\r\nimport { DefaultContentDirective } from './content/default-content.directive';\r\nimport { CoreModuleComponent } from './core-module.component';\r\nimport { DisposableComponent } from './disposable/disposable.component';\r\nimport { HighlightPipe } from './highlight/highlight.pipe';\r\nimport { HttpResponseInterceptor } from './http/http-response.interceptor';\r\nimport { HttpStatusCodeService } from './http/http-status-code.service';\r\nimport { JsonFormatterComponent } from './json-formatter/json-formatter.component';\r\nimport { LabelDirective } from './label/label.directive';\r\nimport { LabelPipe } from './label/label.pipe';\r\nimport { LabelService } from './label/label.service';\r\nimport { Logger } from './logger/logger';\r\nimport { LoggerComponent } from './logger/logger.component';\r\nimport { EventDispatcherService } from './models/event-dispatcher.service';\r\nimport { MenuService } from './models/menu.service';\r\nimport { OnceService } from './once/once.service';\r\nimport { OutletDefaultComponent } from './outlet/outlet-default.component';\r\nimport { OutletRepeaterComponent } from './outlet/outlet-repeater.component';\r\nimport { OutletComponent } from './outlet/outlet.component';\r\nimport { AssetPipe } from './pipes/asset.pipe';\r\nimport { CustomAsyncPipe } from './pipes/custom-async.pipe';\r\nimport { ImageUrlPipe } from './pipes/image-url.pipe';\r\nimport { ImagePipe } from './pipes/image.pipe';\r\nimport { PublicPipe } from './pipes/public.pipe';\r\nimport { SegmentPipe } from './pipes/segment.pipe';\r\nimport { RoutePipe } from './route/route.pipe';\r\nimport { SlugPipe } from './slug/slug.pipe';\r\nimport { CookieStorageService, LocalStorageService, SessionStorageService, StorageService } from './storage/storage.service';\r\nimport { TranslateDirective } from './translate/translate.directive';\r\nimport { TranslatePipe } from './translate/translate.pipe';\r\nimport { TranslateService } from './translate/translate.service';\r\nimport { SafeStylePipe } from './trust/safe-style.pipe';\r\nimport { SafeUrlPipe } from './trust/safe-url.pipe';\r\nimport { TrustPipe } from './trust/trust.pipe';\r\n\r\nconst services = [\r\n\tAuthService,\r\n\tCoreService,\r\n\tCookieStorageService,\r\n\tEventDispatcherService,\r\n\tHttpStatusCodeService,\r\n\tLabelService,\r\n\tLocalStorageService,\r\n\tLogger,\r\n\tMenuService,\r\n\tOnceService,\r\n\tSessionStorageService,\r\n\tStorageService,\r\n\tTranslateService,\r\n];\r\n\r\nconst components = [\r\n\tCoreModuleComponent,\r\n\tDisposableComponent,\r\n\tJsonFormatterComponent,\r\n\tLoggerComponent,\r\n\tOutletComponent,\r\n\tOutletDefaultComponent,\r\n\tOutletRepeaterComponent,\r\n];\r\n\r\nconst directives = [\r\n\tBundleDirective,\r\n\tDefaultContentDirective,\r\n\tLabelDirective,\r\n\tTranslateDirective,\r\n];\r\n\r\nconst pipes = [\r\n\tAssetPipe,\r\n\tCustomAsyncPipe,\r\n\tHighlightPipe,\r\n\tImagePipe,\r\n\tImageUrlPipe,\r\n\tLabelPipe,\r\n\tPublicPipe,\r\n\tRoutePipe,\r\n\tSafeStylePipe,\r\n\tSafeUrlPipe,\r\n\tSegmentPipe,\r\n\tSlugPipe,\r\n\tTranslatePipe,\r\n\tTrustPipe,\r\n];\r\n\r\nconst validators = [\r\n];\r\n\r\nconst guards = [\r\n];\r\n\r\n@NgModule({\r\n\timports: [\r\n\t\tCommonModule,\r\n\t\tHttpClientModule,\r\n\t\tFormsModule,\r\n\t\tReactiveFormsModule,\r\n\t],\r\n\tproviders: [\r\n\t\t{ provide: HTTP_INTERCEPTORS, useClass: HttpResponseInterceptor, multi: true },\r\n\t\t{ provide: NgModuleFactoryLoader, useClass: SystemJsNgModuleLoader },\r\n\t\t...services,\r\n\t\t...pipes,\r\n\t\t...validators,\r\n\t],\r\n\tdeclarations: [\r\n\t\t...components,\r\n\t\t...directives,\r\n\t\t...pipes,\r\n\t\t...validators,\r\n\t],\r\n\tentryComponents: [\r\n\t\t...components\r\n\t],\r\n\texports: [\r\n\t\t...components,\r\n\t\t...directives,\r\n\t\t...pipes,\r\n\t\t...validators,\r\n\t],\r\n})\r\n\r\nexport class CoreModule {\r\n\r\n\tconstructor(\r\n\t\t@Optional() @SkipSelf() parentModule: CoreModule\r\n\t) {\r\n\t\t/*\r\n\t\tif (parentModule) {\r\n\t\t\tthrow new Error('CoreModule is already loaded. Import it in the AppModule only');\r\n\t\t}\r\n\t\t*/\r\n\t}\r\n\r\n\tpublic static forRoot(\r\n\t\tbundles?: Bundles,\r\n\t\tconfig?: CoreConfig,\r\n\t): ModuleWithProviders {\r\n\t\treturn {\r\n\t\t\tngModule: CoreModule,\r\n\t\t\tproviders: [{\r\n\t\t\t\tprovide: CORE_CONFIG, useValue: config\r\n\t\t\t}, {\r\n\t\t\t\tprovide: BUNDLES, useValue: bundles || {}\r\n\t\t\t}]\r\n\t\t};\r\n\t}\r\n\r\n}\r\n","import { Entity } from '../models/entity';\n\nexport class Label implements Entity {\n\tid: string;\n\tvalue?: string;\n\tdefaultValue?: string;\n}\n","import { Entity } from './entity';\n\nexport class Document implements Entity {\n\tid: number | string;\n\tname?: string;\n\ttitle?: string;\n\tdescription?: string;\n\tslug?: string;\n}\n\nexport class DocumentIndex {\n\tid: number | string;\n\tmnemonic?: string;\n\tslug?: string;\n}\n\n","import { Injectable } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport { switchMap } from 'rxjs/operators';\nimport { Document } from './document'; // !!! Document class conflict?\nimport { EntityService } from './entity.service';\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class DocumentService<T extends Document> extends EntityService<T> {\n\n\tget collection(): string {\n\t\treturn '/api/document';\n\t}\n\n\tgetDetailBySlug(slug: string): Observable<T> {\n\t\tif (!slug.trim()) {\n\t\t\t// if not search term, return empty identity array.\n\t\t\treturn of();\n\t\t}\n\t\treturn this.get({ slug }).pipe(\n\t\t\t// tap(x => this.logger.log(`found identities matching \"${slug}\"`)),\n\t\t\tswitchMap(x => of(x[0]))\n\t\t);\n\t}\n\n}\n","import { Identity } from './identity';\n\nexport class Entity implements Identity {\n\tid: number | string;\n\tname?: string;\n}\n","\nexport class Feature {\n\tid: number | string;\n\tslug?: string;\n\ttitle?: string;\n\tabstract?: string;\n\ttype?: number;\n\treadmore?: boolean = false;\n}\n","\nexport class Identity {\n\tid: number | string;\n}\n","import { Document } from './document';\nimport { Image } from './image';\n\nexport class MenuItem implements Document {\n\tid: number | string;\n\tname?: string;\n\ttitle?: string;\n\tabstract?: string;\n\tslug?: string;\n\turl?: string;\n\ttype?: number | string;\n\timages?: Image[];\n\titems?: MenuItem[];\n\n\tconstructor(options?: any) {\n\t\tif (options) {\n\t\t\tObject.assign(this, options);\n\t\t\tif (options.items) {\n\t\t\t\tthis.items = options.items.map(item => new MenuItem(item));\n\t\t\t}\n\t\t}\n\t}\n}\n","\nexport class Taxonomy {\n\tid: number | string;\n\tname?: string;\n\ttype?: number;\n}\n","import { Entity } from '../models/entity';\n\nexport class Translate implements Entity {\n\tid: number | string;\n\tname: string;\n\tlang: string;\n\tlabels?: any;\n}\n"]}