!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/common"),require("@angular/common/http"),require("@designr/core"),require("rxjs"),require("rxjs/operators"),require("@angular/forms"),require("@angular/core")):"function"==typeof define&&define.amd?define("@designr/control",["exports","@angular/common","@angular/common/http","@designr/core","rxjs","rxjs/operators","@angular/forms","@angular/core"],e):e((t.designr=t.designr||{},t.designr.control={}),t.ng.common,t.ng.common.http,t.core,t.rxjs,t.rxjs.operators,t.ng.forms,t.ng.core)}(this,function(t,r,n,o,i,a,l,c){"use strict";var e=function _(t){this.controls={},t&&(Object.assign(this,t),this.controls=t.controls||{})},s=new c.InjectionToken("control.config"),u=function(){function t(){this.version="0.0.3"}return t.prototype.ngOnInit=function(){},t.decorators=[{type:c.Component,args:[{selector:"control-module",template:'<span class="control-module">control {{version}}</span>'}]}],t.ctorParameters=function(){return[]},t}(),p=function(t,e){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function h(t,e){function r(){this.constructor=t}p(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function d(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||0<e--)&&!(n=i.next()).done;)a.push(n.value)}catch(l){o={error:l}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(o)throw o.error}}return a}function f(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(d(arguments[e]));return t}var m=function(){function t(t){this.renderer=t,this.reveal={checked:!1},this.onChange=function(t){},this.onTouched=function(){}}return Object.defineProperty(t.prototype,"controlRef",{get:function(){return this.form.controls[this.control.key]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isValid",{get:function(){return this.controlRef.valid},enumerable:!0,configurable:!0}),t.prototype.getFormattedValue=function(){return this.controlRef.value},t.prototype.onInput=function(t){this.element=t.target,this.onChange(this.element.value)},t.prototype.onFocus=function(t){this.blurred=!1,this.element=t.target,this.renderer.setProperty(this.element,"value",this.controlRef.value)},t.prototype.onBlur=function(t){this.blurred=!0,this.element=t.target,this.renderer.setProperty(this.element,"value",this.controlRef.value)},t.prototype.formatValue=function(t){this.renderer.setProperty(this.element,"value",t)},t.prototype.parseValue=function(t){var e=this.innervalue;this.onChange(e)},t.prototype.writeValue=function(t){this.formatValue(t)},t.prototype.registerOnChange=function(t){this.onChange=t},t.prototype.registerOnTouched=function(t){this.onTouched=t},t.prototype.setDisabledState=function(t){},t.decorators=[{type:c.Component,args:[{selector:"core-control",template:'<ng-container [formGroup]="form">\r\n\t<ng-container [ngSwitch]="control.schema">\r\n\t\t<ng-container *ngSwitchCase="\'checkbox\'">\r\n\t\t\t\x3c!-- CHECKBOX --\x3e\r\n\t\t\t<div class="checkbox">\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<input type="checkbox" class="form-check-input" [id]="control.key" [formControlName]="control.key">\r\n\t\t\t\t\t<span>{{ control.label | label }}</span>\r\n\t\t\t\t</label>\r\n\t\t\t</div>\r\n\t\t</ng-container>\r\n\t\t<ng-container *ngSwitchCase="\'email\'">\r\n\t\t\t\x3c!-- EMAIL --\x3e\r\n\t\t\t<label [attr.for]="control.key">{{ control.label | label }}</label>\r\n\t\t\t<input placeholder="{{ control.placeholder | label }}" class="form-control" [id]="control.key" [formControlName]="control.key" [type]="control.type">\r\n\t\t</ng-container>\r\n\t\t<ng-container *ngSwitchCase="\'number\'">\r\n\t\t\t\x3c!-- NUMBER --\x3e\r\n\t\t\t<label [attr.for]="control.key">{{ control.label | label }}</label>\r\n\t\t\t<input placeholder="{{ control.placeholder | label }}" class="form-control" [id]="control.key" [type]="control.type" [attr.step]="control.step" (input)="onInput($event)" (focus)="onFocus($event)" (blur)="onBlur($event)" [value]="getFormattedValue()">\r\n\t\t</ng-container>\r\n\t\t<ng-container *ngSwitchCase="\'password\'">\r\n\t\t\t\x3c!-- PASSWORD --\x3e\r\n\t\t\t<label [attr.for]="control.key">{{ control.label | label }}</label>\r\n\t\t\t<div class="input-group">\r\n\t\t\t\t<input placeholder="{{ control.placeholder | label }}" class="form-control" [id]="control.key" [formControlName]="control.key" [type]="control.type" #password>\r\n\t\t\t\t<div class="input-group-append" *ngIf="control.type === \'password\'">\r\n\t\t\t\t\t<div class="input-group-text">\r\n\t\t\t\t\t\t<input type="checkbox" [attr.aria-label]="control.label | label" (input)="password.type = reveal.checked ? \'text\' : control.type" #password>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</ng-container>\r\n\t\t<ng-container *ngSwitchCase="\'radio\'">\r\n\t\t\t\x3c!-- RADIO --\x3e\r\n\t\t\t<div class="radio">\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<input type="radio" class="form-radio-input" [id]="control.key" [formControlName]="control.key">\r\n\t\t\t\t\t<span>{{ control.label | label }}</span>\r\n\t\t\t\t</label>\r\n\t\t\t</div>\r\n\t\t</ng-container>\r\n\t\t<ng-container *ngSwitchCase="\'select\'">\r\n\t\t\t\x3c!-- SELECT --\x3e\r\n\t\t\t<label [attr.for]="control.key">{{ control.label | label }}</label>\r\n\t\t\t<select class="form-control" [id]="control.key" [formControlName]="control.key">\r\n\t\t\t\t<option *ngFor="let opt of control.options" [value]="opt.key">{{opt.value}}</option>\r\n\t\t\t</select>\r\n\t\t</ng-container>\r\n\t\t<ng-container *ngSwitchCase="\'markdown\'">\r\n\t\t\t\x3c!-- MARKDOWN --\x3e\r\n\t\t\t<label [attr.for]="control.key">{{ control.label | label }}</label>\r\n\t\t\t<textarea placeholder="{{ control.placeholder | label }}" class="form-control" [id]="control.key" [formControlName]="control.key" rows="4"></textarea>\r\n\t\t</ng-container>\r\n\t\t<ng-container *ngSwitchCase="\'text\'">\r\n\t\t\t\x3c!-- TEXT --\x3e\r\n\t\t\t<label [attr.for]="control.key">{{ control.label | label }}</label>\r\n\t\t\t<input placeholder="{{ control.placeholder | label }}" class="form-control" [id]="control.key" [formControlName]="control.key" [type]="control.type">\r\n\t\t</ng-container>\r\n\t</ng-container>\r\n\t<div *ngIf="controlRef.invalid && (controlRef.dirty || controlRef.touched)" class="alert alert--danger">\r\n\t\t<div *ngIf="controlRef.errors.required">{{ \'errors.required\' | label }}</div>\r\n\t\t<div *ngIf="controlRef.errors.requiredTrue">{{ \'errors.required\' | label }}</div>\r\n\t\t<div *ngIf="controlRef.errors.min">{{ \'errors.min\' | label : null : { min: control.min } }}</div>\r\n\t\t<div *ngIf="controlRef.errors.max">{{ \'errors.max\' | label : null : { max: control.max } }}</div>\r\n\t\t<div *ngIf="controlRef.errors.email">{{ \'errors.email\' | label }}</div>\r\n\t\t<div *ngIf="controlRef.errors.minLength">{{ \'errors.minLength\' | label : null : { minLength: control.minLength } }}</div>\r\n\t\t<div *ngIf="controlRef.errors.maxLength">{{ \'errors.maxLength\' | label : null : { maxLength: control.maxLength } }}</div>\r\n\t\t\x3c!-- <div *ngIf="controlRef.errors.pattern">{{ \'errors.pattern\' | label }}</div> --\x3e\r\n\t\t<div *ngIf="controlRef.errors.match">{{ \'errors.match\' | label }}</div>\r\n\t</div>\r\n</ng-container>\r\n',providers:[{provide:l.NG_VALUE_ACCESSOR,useExisting:c.forwardRef(function(){return t}),multi:!0}]}]}],t.ctorParameters=function(){return[{type:c.Renderer2}]},t.propDecorators={control:[{type:c.Input}],form:[{type:c.Input}]},t}();function g(n,o,i){return void 0===o&&(o=!1),function(t){var e=i.controls[n],r=t.value;return e&&r!==e.value&&!o?{match:!0}:(e&&r===e.value&&o&&e.errors&&(delete e.errors.match,Object.keys(e.errors).length||e.setErrors(null)),e&&r!==e.value&&o&&e.setErrors({match:!0}),null)}}var v=function(){function t(t){t=t||{},this.options=new e(t)}return t.prototype.getValidators=function(t,e){var r=[];return t.min&&r.push(l.Validators.min(t.min)),t.max&&r.push(l.Validators.max(t.max)),t.required&&r.push(l.Validators.required),t.requiredTrue&&r.push(l.Validators.requiredTrue),t.email&&r.push(l.Validators.email),t.minLength&&r.push(l.Validators.minLength(t.minLength)),t.maxLength&&r.push(l.Validators.maxLength(t.maxLength)),t.pattern&&r.push(l.Validators.pattern(t.pattern)),t.match&&r.push(g(t.match,t.reverse,e)),r},t.prototype.toFormGroup=function(t){var r=this,n={};t.forEach(function(t){var e=new l.FormControl(t.value);t.disabled&&e.disable(),n[t.key]=e});var o=new l.FormGroup(n);return t.forEach(function(t){var e=r.getValidators(t,o);o.controls[t.key].setValidators(e)}),o},t.decorators=[{type:c.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:e,decorators:[{type:c.Inject,args:[s]}]}]},t.ngInjectableDef=c.defineInjectable({factory:function(){return new t(c.inject(s))},token:t,providedIn:"root"}),t}(),y=function(){function t(){var e=this;this.values=new i.BehaviorSubject(null),this.debounced$=this.values.pipe(a.debounceTime(250),a.switchMap(function(t){return e.exists$(t)}),a.catchError(function(t){return console.log("ExistsValidator.debounced$.catchError",t),i.of(null)}),a.take(1))}return Object.defineProperty(t.prototype,"value",{set:function(t){t&&""!==t.trim()&&this.values.next(t)},enumerable:!0,configurable:!0}),t.prototype.exists$=function(t){return"function"==typeof this.exists?this.exists(t).pipe(a.switchMap(function(t){return t?i.of({exists:!0}):i.of(null)})):i.of(null)},t.prototype.validate=function(t){return this.value=t.value,this.debounced$},t.decorators=[{type:c.Directive,args:[{selector:"[exists][formControlName],[exists][formControl],[exists][ngModel]",providers:[{provide:l.NG_ASYNC_VALIDATORS,useExisting:c.forwardRef(function(){return t}),multi:!0}]}]}],t.propDecorators={exists:[{type:c.Input}]},t}(),b=function(){function t(t,e){this.match=t,this.reverse=e}return Object.defineProperty(t.prototype,"isReverse",{get:function(){return!!this.reverse&&"true"===this.reverse},enumerable:!0,configurable:!0}),t.prototype.validate=function(t){var e=t.value,r=t.root.get(this.match);return r&&e!==r.value&&!this.isReverse?{match:!0}:(r&&e===r.value&&this.isReverse&&(delete r.errors.match,Object.keys(r.errors).length||r.setErrors(null)),r&&e!==r.value&&this.isReverse&&r.setErrors({match:!0}),null)},t.decorators=[{type:c.Directive,args:[{selector:"[match][formControlName],[match][formControl],[match][ngModel]",providers:[{provide:l.NG_VALIDATORS,useExisting:c.forwardRef(function(){return t}),multi:!0}]}]}],t.ctorParameters=function(){return[{type:String,decorators:[{type:c.Attribute,args:["match"]}]},{type:String,decorators:[{type:c.Attribute,args:["reverse"]}]}]},t}(),x=function(){function t(){this.ngModelChange=new c.EventEmitter}return t.prototype.onInputChange=function(t){this.value=t.target.value.toUpperCase(),this.ngModelChange.emit(this.value)},t.decorators=[{type:c.Directive,args:[{selector:"[ngModel][uppercase]"}]}],t.propDecorators={ngModelChange:[{type:c.Output}],onInputChange:[{type:c.HostListener,args:["input",["$event"]]}]},t}(),C=function D(){},w=function(){function r(t){void 0===t&&(t={}),this._originalValue=t.value,this.value=t.value,this.key=t.key;var e=(t.key||"Control")+" "+ ++r.uid;this.label=t.label||e,this.placeholder=t.placeholder||e,this.order=t.order===undefined?1:t.order,this.schema=t.schema||"text",this.type=t.type||this.schema,this.min=t.min||null,this.max=t.max||null,this.required=!!t.required,this.requiredTrue=!!t.requiredTrue,this.email=!!t.email,this.minLength=t.minLength||null,this.maxLength=t.maxLength||null,this.pattern=t.pattern||null,this.match=t.match||null,this.reverse=!!t.reverse,this.options=t.options||[],this.disabled=!!t.disabled,this.step=t.step||null,this.format=t.format||null}return r.uid=0,r}(),k=function(r){function t(t){void 0===t&&(t={});var e=r.call(this,t)||this;return e.schema="checkbox",e.type=t.type||e.type,e}return h(t,r),t}(w),I=function(r){function t(t){void 0===t&&(t={});var e=r.call(this,t)||this;return e.schema="email",e.type=t.type||e.type,e.email=!0,e.pattern=t.pattern||"[a-zA-Z0-9.-_]{1,}@[a-zA-Z.-]{2,}[.]{1}[a-zA-Z]{2,}",e}return h(t,r),t}(w),R=function(r){function t(t){void 0===t&&(t={});var e=r.call(this,t)||this;return e.schema="markdown",e.type=t.type||e.type,e}return h(t,r),t}(w),O=function(r){function t(t){void 0===t&&(t={});var e=r.call(this,t)||this;return e.schema="number",e.type=t.type||e.type,e}return h(t,r),t}(w),V=function(r){function t(t){void 0===t&&(t={});var e=r.call(this,t)||this;return e.schema="password",e.type=t.type||e.type,e}return h(t,r),t}(w),S=function(r){function t(t){void 0===t&&(t={});var e=r.call(this,t)||this;return e.schema="radio",e.type=t.type||e.type,e}return h(t,r),t}(w),j=function(r){function t(t){void 0===t&&(t={});var e=r.call(this,t)||this;return e.schema="select",e.options=[],e.options=t.options||[],e}return h(t,r),t}(w),E=function(r){function t(t){void 0===t&&(t={});var e=r.call(this,t)||this;return e.schema="text",e.type=t.type||e.type,e}return h(t,r),t}(w),L=function(){function t(t){this.controlService=t}return t.prototype.getControlsFromOptions=function(t){var e=t.map(function(t){switch(t.schema){case"checkbox":return new k(t);case"email":return new I(t);case"number":return new O(t);case"password":return new V(t);case"radio":return new S(t);case"select":return new j(t);case"markdown":return new R(t);case"text":default:return new E(t)}});return e.sort(function(t,e){return t.order-e.order}),e},t.prototype.getGroupFromOptions=function(t){var e=this.getControlsFromOptions(t);return this.controlService.toFormGroup(e)},t.prototype.getGroupFromControls=function(t){return this.controlService.toFormGroup(t)},t.decorators=[{type:c.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:v}]},t.ngInjectableDef=c.defineInjectable({factory:function(){return new t(c.inject(v))},token:t,providedIn:"root"}),t}(),M=[v,L],A=[m,u],q=[x],N=[],P=[y,b],F=function(){function e(t){}return e.forRoot=function(t){return{ngModule:e,providers:[{provide:s,useValue:t}]}},e.decorators=[{type:c.NgModule,args:[{imports:[r.CommonModule,n.HttpClientModule,l.FormsModule,l.ReactiveFormsModule,o.CoreModule],providers:f(M,N,P),declarations:f(A,q,N,P),exports:f(A,q,N,P)}]}],e.ctorParameters=function(){return[{type:e,decorators:[{type:c.Optional},{type:c.SkipSelf}]}]},e}(),T=function(){function t(){this.changed=new Array,this.touched=new Array}return Object.defineProperty(t.prototype,"value",{get:function(){return this.innerValue},set:function(e){this.innerValue!==e&&(this.innerValue=e,this.changed.forEach(function(t){return t(e)}))},enumerable:!0,configurable:!0}),t.prototype.touch=function(){this.touched.forEach(function(t){return t()})},t.prototype.writeValue=function(t){this.innerValue=t},t.prototype.registerOnChange=function(t){this.changed.push(t)},t.prototype.registerOnTouched=function(t){this.touched.push(t)},t}();t.ControlConfig=e,t.CONTROL_CONFIG=s,t.ControlModuleComponent=u,t.ControlModule=F,t.ControlBase=w,t.ControlBaseOptions=C,t.ControlCheckbox=k,t.ControlEmail=I,t.ControlMarkdown=R,t.ControlNumber=O,t.ControlPassword=V,t.ControlRadio=S,t.ControlSelect=j,t.ControlText=E,t.ValueAccessorBase=T,t.ControlComponent=m,t.ControlService=v,t.ExistsValidator=y,t.MatchValidator=b,t.matchValidator=g,t.UppercaseDirective=x,t.FormService=L,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=designr-control.umd.min.js.map