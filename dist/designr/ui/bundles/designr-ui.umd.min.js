!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common"),require("rxjs"),require("rxjs/operators"),require("@angular/core"),require("@designr/core")):"function"==typeof define&&define.amd?define("@designr/ui",["exports","@angular/common","rxjs","rxjs/operators","@angular/core","@designr/core"],t):t((e.designr=e.designr||{},e.designr.ui={}),e.ng.common,e.rxjs,e.rxjs.operators,e.ng.core,e.core)}(this,function(e,o,t,n,i,r){"use strict";var a=function k(e){console.log("UIConfig",e),e&&Object.assign(this,e)},s=new i.InjectionToken("ui.config"),c=function(){function e(e){console.log("UIService",e),e=e||{},this.options=new a(e)}return e.decorators=[{type:i.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:a,decorators:[{type:i.Inject,args:[s]}]}]},e.ngInjectableDef=i.defineInjectable({factory:function(){return new e(i.inject(s))},token:e,providedIn:"root"}),e}(),l=function(){function e(){this.version="0.0.2"}return e.prototype.ngOnInit=function(){},e.decorators=[{type:i.Component,args:[{selector:"ui-module",template:'<span class="ui-module">ui {{version}}</span>'}]}],e.ctorParameters=function(){return[]},e}(),d=function(e,t){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)};function u(e,t){function o(){this.constructor=e}d(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}function p(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i["return"])&&o.call(i)}finally{if(r)throw r.error}}return a}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}var f=function(){function e(e){this.element=e,this.clickOutside=new i.EventEmitter}return e.prototype.onClick=function(e){var t=e.target;this.element.nativeElement.contains(t)||!document.contains(t)||this.clickOutside.emit(null)},e.decorators=[{type:i.Directive,args:[{selector:"[clickOutside]"}]}],e.ctorParameters=function(){return[{type:i.ElementRef}]},e.propDecorators={clickOutside:[{type:i.Output}],onClick:[{type:i.HostListener,args:["document:click",["$event"]]}]},e}(),g=function(){function e(e,t,o){this.platformId=e,this.zone=t,this.element=o}return e.prototype.ngAfterViewInit=function(){var n=this;o.isPlatformBrowser(this.platformId)&&this.zone.runOutsideAngular(function(){$(function(){var o=Array.from($(n.element.nativeElement).find(n.target));o.forEach(function(e,t){return e.addEventListener("click",function(e){$.fancybox.open(o,n.fancybox,t),e.preventDefault(),e.stopImmediatePropagation()})})})})},e.decorators=[{type:i.Directive,args:[{selector:"[fancybox]"}]}],e.ctorParameters=function(){return[{type:String,decorators:[{type:i.Inject,args:[i.PLATFORM_ID]}]},{type:i.NgZone},{type:i.ElementRef}]},e.propDecorators={fancybox:[{type:i.Input}],target:[{type:i.Input}]},e}(),h=function(){function e(e,t,o,n){this.platformId=e,this.renderer=o,this.zone=n,this.nativeElement=t.nativeElement}return e.prototype.ngOnInit=function(){var e=this;o.isPlatformBrowser(this.platformId)&&this.zone.runOutsideAngular(function(){require("intersection-observer"),e.onRegister()})},e.prototype.ngOnDestroy=function(){this.observer&&this.observer.disconnect()},e.prototype.onRegister=function(){var t=this;this.newIntersectionObserver();new MutationObserver(function(e){return t.onChange(e)}).observe(this.nativeElement,{attributes:!0,characterData:!0,childList:!0,subtree:!0}),this.onChange()},e.prototype.onChange=function(){for(var t=this,e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];Array.from(this.nativeElement.querySelectorAll("img[data-src], [data-srcset], [data-background-src]")).forEach(function(e){return t.observer.observe(e)})},e.prototype.newIntersectionObserver=function(){var t=this,e=this.lazyImages instanceof Object?this.lazyImages:undefined;return this.observer=new IntersectionObserver(function(e){return e.forEach(function(e){e.isIntersecting&&t.onAppearsInViewport(e.target)})},e),this.observer},e.prototype.onAppearsInViewport=function(t){var o=this;if(t.dataset.src){var e=t.dataset.src;this.onImagePreload(e,function(e){o.renderer.setAttribute(t,"src",e),o.renderer.removeAttribute(t,"data-src"),o.zone.runOutsideAngular(function(){setTimeout(function(){o.renderer.addClass(t,"ready")},1)})})}t.dataset.srcset&&(this.renderer.setAttribute(t,"srcset",t.dataset.srcset),this.renderer.removeAttribute(t,"data-srcset")),t.dataset.backgroundSrc&&(this.renderer.setStyle(t,"background-image","url("+t.dataset.backgroundSrc+")"),this.renderer.removeAttribute(t,"data-background-src")),this.observer&&this.observer.unobserve(t)},e.prototype.onImagePreload=function(e,t){var o=new Image;o.onload=function(){"function"==typeof t&&t(o.src)},o.onerror=function(e){o.onerror=null,o.src="data:image/png;base64,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"},o.src=e},e.decorators=[{type:i.Directive,args:[{selector:"[lazy-images]"}]}],e.ctorParameters=function(){return[{type:String,decorators:[{type:i.Inject,args:[i.PLATFORM_ID]}]},{type:i.ElementRef},{type:i.Renderer2},{type:i.NgZone}]},e.propDecorators={lazyImages:[{type:i.Input}]},e}(),v={Complete:0,Close:1};v[v.Complete]="Complete",v[v.Close]="Close";var I=function O(e){this.type=v.Complete,e&&Object.assign(this,e)},y=function P(e){this.type=v.Close,e&&Object.assign(this,e)},A=function(){function e(e){this.providers=[],this.emitter=new i.EventEmitter,e&&Object.assign(this,e)}return e.decorators=[{type:i.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:e}]},e.ngInjectableDef=i.defineInjectable({factory:function(){return new e(i.inject(e))},token:e,providedIn:"root"}),e}(),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.decorators=[{type:i.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=i.defineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(Object),b=function(){function e(e){this.platformId=e,this.modals$=new t.BehaviorSubject([])}return e.prototype.getInfos=function(){return this.modals$.pipe(n.map(function(e){return e.length?e[e.length-1]:null}))},e.prototype.addClass=function(e){o.isPlatformBrowser(this.platformId)&&document.querySelector("body").classList.add(e)},e.prototype.removeClass=function(e){o.isPlatformBrowser(this.platformId)&&document.querySelector("body").classList.remove(e)},e.prototype.open=function(e){this.addClass("modal-active"),e=new A(e);var t=this.modals$.getValue();return t.push(e),this.modals$.next(t),e.emitter},e.prototype.complete=function(e,t){(e=e?this.remove(e):this.pop())&&e.emitter.emit(new I({modal:e,data:t}))},e.prototype.close=function(e,t){(e=this.removeAll())&&e.emitter.emit(new y({modal:e,data:t}))},e.prototype.prev=function(e,t){(e=e?this.remove(e):this.pop())&&e.emitter.emit(new y({modal:e,data:t}))},e.prototype.pop=function(){var e=this.modals$.getValue();if(e.length){var t=e.pop();return e.length||this.removeClass("modal-active"),this.modals$.next(e),t}return null},e.prototype.remove=function(e){var t=this.modals$.getValue();return t.length&&t[t.length-1]===e?(t.pop(),t.length||this.removeClass("modal-active"),this.modals$.next(t),e):null},e.prototype.removeAll=function(){var e=this.modals$.getValue();if(e.length){var t=e.pop();return this.removeClass("modal-active"),this.modals$.next([]),t}return null},e.decorators=[{type:i.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:String,decorators:[{type:i.Inject,args:[i.PLATFORM_ID]}]}]},e.ngInjectableDef=i.defineInjectable({factory:function(){return new e(i.inject(i.PLATFORM_ID))},token:e,providedIn:"root"}),e}(),E=function(o){function e(e){var t=o.call(this)||this;return t.modalService=e,t.modalCount=0,t}return u(e,o),e.prototype.ngOnInit=function(){var t=this;this.modalService.modals$.pipe(n.takeUntil(this.unsubscribe),n.map(function(e){return t.modalCount=e.length,e.length?e[e.length-1]:null})).subscribe(function(e){t.className=e?e.className:null})},e.prototype.doClose=function(){this.modalService.close()},e.prototype.doPrev=function(){this.modalService.prev()},e.decorators=[{type:i.Component,args:[{selector:"core-modal-container-component",template:'<div class="modal" [ngClass]="{ active: modalCount > 0 }">\r\n\t<div class="modal-bg" (click)="doClose()"></div>\r\n\t<div class="modal-page" [ngClass]="className">\r\n\t\t<div class="modal-header">\r\n\t\t\t<button type="button" class="modal-prev" (click)="doPrev()" title="Indietro" *ngIf="modalCount > 1">\r\n\t\t\t\t<svg class="ico">\r\n\t\t\t\t\t<use xlink:href="#ico-prev"></use>\r\n\t\t\t\t</svg>\r\n\t\t\t\tindietro\r\n\t\t\t</button>\r\n\t\t\t<button type="button" class="modal-close" (click)="doClose()" title="Chiudi finestra">\r\n\t\t\t\t<svg class="ico">\r\n\t\t\t\t\t<use xlink:href="#ico-close"></use>\r\n\t\t\t\t</svg>\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t\t<div class="modal-content">\r\n\t\t\t<ng-container *ngFor="let modal of (modalService.modals$ | async); let last = last;">\r\n\t\t\t\t<core-modal-view-component [modal]="modal" [hidden]="!last"></core-modal-view-component>\r\n\t\t\t</ng-container>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n',encapsulation:i.ViewEncapsulation.Emulated,styles:[".modal{position:fixed;display:flex;justify-content:center;align-items:center;top:0;left:0;width:100%;height:100%;z-index:10000;margin:0;padding:0;overflow:hidden;pointer-events:none;opacity:0;transition:opacity 250ms ease-in-out}.modal.active{opacity:1;pointer-events:all}.modal-bg{position:fixed;z-index:0;background:#1e1e1e;opacity:.87;top:0;left:0;bottom:0;right:0}.modal-page{position:relative;z-index:1;background:#fff;max-height:90vh;max-width:90vw;box-shadow:0 10px 40px -5px rgba(0,0,0,.5);overflow-y:auto}@media (max-width:500px){.modal-page{max-height:calc(100% - 80px);margin-top:40px;width:90%;max-width:none}}.modal-page .modal-header .modal-prev{padding:10px;z-index:1;color:#5f5d63;display:flex;font-size:11px;align-items:center;text-transform:uppercase;margin-left:4px}.modal-page .modal-header .modal-prev .ico{width:12px;height:12px;fill:#5f5d63;margin-right:4px}.modal-page .modal-header .modal-close{position:fixed;z-index:1;right:10px;top:10px}.modal-page .modal-header .modal-close .ico{fill:#fff;width:32px;height:32px}"]}]}],e.ctorParameters=function(){return[{type:b}]},e}(r.DisposableComponent),w=function(o){function e(e){var t=o.call(this)||this;return t.resolver=e,t}return u(e,o),Object.defineProperty(e.prototype,"modal",{set:function(t){if(this.component&&this.component.destroy(),t){var e=Object.keys(t.providers).map(function(e){return{provide:e,useValue:t.providers[e]}});e.push({provide:C,useValue:t.data},{provide:A,useValue:t});var o=i.ReflectiveInjector.resolve(e),n=i.ReflectiveInjector.fromResolvedProviders(o,this.modalContainer.parentInjector),r=this.resolver.resolveComponentFactory(t.component).create(n);this.modalContainer.insert(r.hostView),this.component=r}else this.component=null},enumerable:!0,configurable:!0}),e.prototype.ngOnDestroy=function(){this.component&&(this.component.destroy(),this.component=null)},e.decorators=[{type:i.Component,args:[{selector:"core-modal-view-component",template:"<ng-container #modalContainer></ng-container>\r\n",encapsulation:i.ViewEncapsulation.Emulated,styles:[""]}]}],e.ctorParameters=function(){return[{type:i.ComponentFactoryResolver}]},e.propDecorators={modalContainer:[{type:i.ViewChild,args:["modalContainer",{read:i.ViewContainerRef}]}],modal:[{type:i.Input}]},e}(r.DisposableComponent),x=[c,b],j=[l,E,w],Q=[f,g,h],B=function(){function t(e){if(e)throw new Error("UIModule is already loaded. Import it in the AppModule only")}return t.forRoot=function(e){return{ngModule:t,providers:[{provide:s,useValue:e}]}},t.decorators=[{type:i.NgModule,args:[{imports:[o.CommonModule,r.CoreModule],providers:m(x),declarations:m(j,Q),exports:m([r.CoreModule],j,Q)}]}],t.ctorParameters=function(){return[{type:t,decorators:[{type:i.Optional},{type:i.SkipSelf}]}]},t}();e.UIConfig=a,e.UI_CONFIG=s,e.UIService=c,e.UIModuleComponent=l,e.UIModule=B,e.ClickOutsideDirective=f,e.FancyboxDirective=g,e.LazyImagesDirective=h,e.ModalContainerComponent=E,e.ModalViewComponent=w,e.ModalService=b,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=designr-ui.umd.min.js.map