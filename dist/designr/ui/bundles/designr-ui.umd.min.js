!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common"),require("@designr/core"),require("rxjs"),require("rxjs/operators"),require("@angular/core")):"function"==typeof define&&define.amd?define("@designr/ui",["exports","@angular/common","@designr/core","rxjs","rxjs/operators","@angular/core"],t):t((e.designr=e.designr||{},e.designr.ui={}),e.ng.common,e.core,e.rxjs,e.rxjs.operators,e.ng.core)}(this,function(e,r,n,i,s,a){"use strict";var t=function R(e){e&&Object.assign(this,e)},o=new a.InjectionToken("ui.config"),c=function(){function e(e){e=e||{},this.options=new t(e)}return e.decorators=[{type:a.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:t,decorators:[{type:a.Inject,args:[o]}]}]},e.ngInjectableDef=a.defineInjectable({factory:function(){return new e(a.inject(o))},token:e,providedIn:"root"}),e}(),l=function(){function e(){this.version="0.0.3"}return e.prototype.ngOnInit=function(){},e.decorators=[{type:a.Component,args:[{selector:"ui-module",template:'<span class="ui-module">ui {{version}}</span>'}]}],e.ctorParameters=function(){return[]},e}(),u=function(e,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function p(e,t){function n(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function d(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i["return"])&&n.call(i)}finally{if(o)throw o.error}}return s}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(d(arguments[t]));return e}var f=function(){function e(e){this.element=e,this.clickOutside=new a.EventEmitter}return e.prototype.onClick=function(e){var t=e.target;this.element.nativeElement.contains(t)||!document.contains(t)||this.clickOutside.emit(null)},e.decorators=[{type:a.Directive,args:[{selector:"[clickOutside]"}]}],e.ctorParameters=function(){return[{type:a.ElementRef}]},e.propDecorators={clickOutside:[{type:a.Output}],onClick:[{type:a.HostListener,args:["document:click",["$event"]]}]},e}(),g=function(){function e(e,t,n,r){this.platformId=e,this.renderer=n,this.zone=r,this.nativeElement=t.nativeElement}return e.prototype.ngOnInit=function(){var e=this;r.isPlatformBrowser(this.platformId)&&this.zone.runOutsideAngular(function(){require("intersection-observer"),e.onRegister()})},e.prototype.ngOnDestroy=function(){this.observer&&this.observer.disconnect()},e.prototype.onRegister=function(){var t=this;this.newIntersectionObserver();new MutationObserver(function(e){return t.onChange(e)}).observe(this.nativeElement,{attributes:!0,characterData:!0,childList:!0,subtree:!0}),this.onChange()},e.prototype.onChange=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Array.from(this.nativeElement.querySelectorAll("img[data-src], [data-srcset], [data-background-src]")).forEach(function(e){return t.observer.observe(e)})},e.prototype.newIntersectionObserver=function(){var t=this,e=this.lazyImages instanceof Object?this.lazyImages:undefined;return this.observer=new IntersectionObserver(function(e){return e.forEach(function(e){e.isIntersecting&&t.onAppearsInViewport(e.target)})},e),this.observer},e.prototype.onAppearsInViewport=function(t){var n=this;if(t.dataset.src){var e=t.dataset.src;this.onImagePreload(e,function(e){n.renderer.setAttribute(t,"src",e),n.renderer.removeAttribute(t,"data-src"),n.zone.runOutsideAngular(function(){setTimeout(function(){n.renderer.addClass(t,"ready")},1)})})}t.dataset.srcset&&(this.renderer.setAttribute(t,"srcset",t.dataset.srcset),this.renderer.removeAttribute(t,"data-srcset")),t.dataset.backgroundSrc&&(this.renderer.setStyle(t,"background-image","url("+t.dataset.backgroundSrc+")"),this.renderer.removeAttribute(t,"data-background-src")),this.observer&&this.observer.unobserve(t)},e.prototype.onImagePreload=function(e,t){var n=new Image;n.onload=function(){"function"==typeof t&&t(n.src)},n.onerror=function(e){n.onerror=null,n.src="data:image/png;base64,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"},n.src=e},e.decorators=[{type:a.Directive,args:[{selector:"[lazy-images]"}]}],e.ctorParameters=function(){return[{type:String,decorators:[{type:a.Inject,args:[a.PLATFORM_ID]}]},{type:a.ElementRef},{type:a.Renderer2},{type:a.NgZone}]},e.propDecorators={lazyImages:[{type:a.Input}]},e}(),v={Complete:0,Close:1};v[v.Complete]="Complete",v[v.Close]="Close";var h=function P(e){this.type=v.Complete,e&&Object.assign(this,e)},I=function S(e){this.type=v.Close,e&&Object.assign(this,e)},y=function(){function e(e){this.providers=[],this.emitter=new a.EventEmitter,e&&Object.assign(this,e)}return e.decorators=[{type:a.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:e}]},e.ngInjectableDef=a.defineInjectable({factory:function(){return new e(a.inject(e))},token:e,providedIn:"root"}),e}(),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return p(t,e),t.decorators=[{type:a.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=a.defineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(Object),A=function(){function e(e){this.platformId=e,this.modals$=new i.BehaviorSubject([])}return e.prototype.getInfos=function(){return this.modals$.pipe(s.map(function(e){return e.length?e[e.length-1]:null}))},e.prototype.addClass=function(e){r.isPlatformBrowser(this.platformId)&&document.querySelector("body").classList.add(e)},e.prototype.removeClass=function(e){r.isPlatformBrowser(this.platformId)&&document.querySelector("body").classList.remove(e)},e.prototype.open=function(e){this.addClass("modal-active"),e=new y(e);var t=this.modals$.getValue();return t.push(e),this.modals$.next(t),e.emitter},e.prototype.complete=function(e,t){(e=e?this.remove(e):this.pop())&&e.emitter.emit(new h({modal:e,data:t}))},e.prototype.close=function(e,t){(e=this.removeAll())&&e.emitter.emit(new I({modal:e,data:t}))},e.prototype.prev=function(e,t){(e=e?this.remove(e):this.pop())&&e.emitter.emit(new I({modal:e,data:t}))},e.prototype.pop=function(){var e=this.modals$.getValue();if(e.length){var t=e.pop();return e.length||this.removeClass("modal-active"),this.modals$.next(e),t}return null},e.prototype.remove=function(e){var t=this.modals$.getValue();return t.length&&t[t.length-1]===e?(t.pop(),t.length||this.removeClass("modal-active"),this.modals$.next(t),e):null},e.prototype.removeAll=function(){var e=this.modals$.getValue();if(e.length){var t=e.pop();return this.removeClass("modal-active"),this.modals$.next([]),t}return null},e.decorators=[{type:a.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:String,decorators:[{type:a.Inject,args:[a.PLATFORM_ID]}]}]},e.ngInjectableDef=a.defineInjectable({factory:function(){return new e(a.inject(a.PLATFORM_ID))},token:e,providedIn:"root"}),e}(),b=function(n){function e(e){var t=n.call(this)||this;return t.modalService=e,t.modalCount=0,t}return p(e,n),e.prototype.ngOnInit=function(){var t=this;this.modalService.modals$.pipe(s.takeUntil(this.unsubscribe),s.map(function(e){return t.modalCount=e.length,e.length?e[e.length-1]:null})).subscribe(function(e){t.className=e?e.className:null})},e.prototype.doClose=function(){this.modalService.close()},e.prototype.doPrev=function(){this.modalService.prev()},e.decorators=[{type:a.Component,args:[{selector:"core-modal-container-component",template:'<div class="modal" [ngClass]="{ active: modalCount > 0 }">\r\n\t<div class="modal-bg" (click)="doClose()"></div>\r\n\t<div class="modal-page" [ngClass]="className">\r\n\t\t<div class="modal-header">\r\n\t\t\t<button type="button" class="btn btn--prev" (click)="doPrev()" *ngIf="modalCount > 1" [title]="\'modal.back\' | label : \'back\'">\r\n\t\t\t\t<span sprite="ico-prev"></span>\r\n\t\t\t\t<span>{{\'modal.back\' | label : \'back\'}}</span>\r\n\t\t\t</button>\r\n\t\t\t<button type="button" class="btn btn--close" (click)="doClose()" title="\'modal.close\' | label : \'close\'">\r\n\t\t\t\t<span sprite="ico-close"></span>\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t\t<div class="modal-content">\r\n\t\t\t<ng-container *ngFor="let modal of (modalService.modals$ | async); let last = last;">\r\n\t\t\t\t<core-modal-view-component [modal]="modal" [hidden]="!last"></core-modal-view-component>\r\n\t\t\t</ng-container>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n',encapsulation:a.ViewEncapsulation.Emulated}]}],e.ctorParameters=function(){return[{type:A}]},e}(n.DisposableComponent),E=function(n){function e(e){var t=n.call(this)||this;return t.resolver=e,t}return p(e,n),Object.defineProperty(e.prototype,"modal",{set:function(t){if(this.component&&this.component.destroy(),t){var e=Object.keys(t.providers).map(function(e){return{provide:e,useValue:t.providers[e]}});e.push({provide:C,useValue:t.data},{provide:y,useValue:t});var n=a.ReflectiveInjector.resolve(e),r=a.ReflectiveInjector.fromResolvedProviders(n,this.modalContainer.parentInjector),o=this.resolver.resolveComponentFactory(t.component).create(r);this.modalContainer.insert(o.hostView),this.component=o}else this.component=null},enumerable:!0,configurable:!0}),e.prototype.ngOnDestroy=function(){this.component&&(this.component.destroy(),this.component=null)},e.decorators=[{type:a.Component,args:[{selector:"core-modal-view-component",template:"<ng-container #modalContainer></ng-container>\r\n",encapsulation:a.ViewEncapsulation.Emulated}]}],e.ctorParameters=function(){return[{type:a.ComponentFactoryResolver}]},e.propDecorators={modalContainer:[{type:a.ViewChild,args:["modalContainer",{read:a.ViewContainerRef}]}],modal:[{type:a.Input}]},e}(n.DisposableComponent),j=function(o){function e(e,t,n){var r=o.call(this)||this;return r.platformId=e,r.zone=t,r.elementRef=n,r.scroll=new a.EventEmitter,r.scrollEvent=new i.Observable(function(e){return r.zone.runOutsideAngular(function(){return i.fromEvent(r.elementRef.nativeElement,"scroll").pipe(s.takeUntil(r.unsubscribe)).subscribe(e)})}),r.scrollDocumentEvent=new i.Observable(function(e){return r.zone.runOutsideAngular(function(){return i.fromEvent(window.document,"scroll").pipe(s.takeUntil(r.unsubscribe)).subscribe(e)})}),r}return p(e,o),e.prototype.ngOnInit=function(){var n=this;r.isPlatformBrowser(this.platformId)&&this.scrollDocumentEvent.subscribe(function(e){var t={scrollHeight:document.scrollingElement.scrollHeight,scrollLeft:document.scrollingElement.scrollLeft,scrollTop:document.scrollingElement.scrollTop,scrollWidth:document.scrollingElement.scrollWidth,originalEvent:e};n.scroll.emit(t)})},e.decorators=[{type:a.Directive,args:[{selector:"[scroll]"}]}],e.ctorParameters=function(){return[{type:String,decorators:[{type:a.Inject,args:[a.PLATFORM_ID]}]},{type:a.NgZone},{type:a.ElementRef}]},e.propDecorators={scroll:[{type:a.Output}]},e}(n.DisposableComponent),w=function(){function e(){}return e.decorators=[{type:a.Component,args:[{selector:"[sprite]",template:'<ng-container *ngIf="sprite">\n\t<svg class="sprite"><use attr.xlink:href="#{{sprite}}"></use></svg>\n</ng-container>'}]}],e.propDecorators={sprite:[{type:a.Input}]},e}(),Q=[c,A],O=[l,b,E,w],B=[f,g,j],k=function(){function t(e){if(e)throw new Error("UIModule is already loaded. Import it in the AppModule only")}return t.forRoot=function(e){return{ngModule:t,providers:[{provide:o,useValue:e}]}},t.decorators=[{type:a.NgModule,args:[{imports:[r.CommonModule,n.CoreModule],providers:m(Q),declarations:m(O,B),exports:m([n.CoreModule],O,B)}]}],t.ctorParameters=function(){return[{type:t,decorators:[{type:a.Optional},{type:a.SkipSelf}]}]},t}();e.UIConfig=t,e.UI_CONFIG=o,e.UIService=c,e.UIModuleComponent=l,e.UIModule=k,e.ClickOutsideDirective=f,e.LazyImagesDirective=g,e.ModalCompleteEvent=h,e.ModalData=C,e.ModalContainerComponent=b,e.ModalViewComponent=E,e.ModalService=A,e.ScrollDirective=j,e.ɵa=w,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=designr-ui.umd.min.js.map